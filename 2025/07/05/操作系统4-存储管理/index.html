<!DOCTYPE html>
<html>
<meta charset="utf-8" />
  <!-- 标签页 -->
  <!-- 标签页 -->
<title>
    存储管理
</title>


<link rel="shortcut icon" href="/icon.svg">


  <body>  
    <!-- 配置引用 -->
    <script>
  window.THEME_CONFIG = {
    image: {
      enable: 'true',
      center: 'true',
      caption: 'false'
    },
    code_block: {
      copy_button: "icon/copy.svg",
      theme_toggle: {
        enable: 'true',
        to_light_button: "icon/light.svg",
        to_dark_button: "icon/dark.svg",
        light_theme: "/css/vscode-modern-light.css",
        dark_theme: "/css/vscode-modern-dark.css"
      },
      mac_enhancer: {
        enable: 'true',
        init_folded_status: 'true'
      }
    },
    giscus: {
      repo: "Kytolly/MyGiscus",
      repo_id: "R_kgDOK_0_0A",
      category: "Announcements",
      category_id: "DIC_kwDOK_0_0A",
      mapping: "pathname",
      strict: "0",
      reactions_enabled: "1",
      emit_metadata: "0",
      input_position: "top",
      lang: "zh-CN",
      loading: "lazy"
    },
    heading_numbering: 'true',
    three_line_table: 'true',
    background: {
      enable: 'true',
      folder: 'img/',
      opacity: '0.1',
      position: 'center',
      size: 'cover',
      repeat: 'no-repeat',
      image: {
        mode: 'random',
        name: 'background.jpg',
        count: '113'
      }
    },
  };
</script>
<script>
  console.log(window.THEME_CONFIG);
</script>

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    
    <!-- 字体 -->
    <!-- 字体 -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <!-- 代码块 -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
      
        <link rel="stylesheet" href="/css/vscode-modern-light.css">
        <link rel="stylesheet" href="/css/vscode-modern-dark.css">
        <!-- DEBUG: url_for light path: /css/vscode-modern-light.css -->
        <!-- DEBUG: url_for dark path: /css/vscode-modern-dark.css -->
      
    
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>

    <!-- 数学公式 -->
    
<link rel="stylesheet" href="/css/mathjax.css">

    
<script src="/js/mathjax.js"></script>

    
    <!-- 标题编号 -->
    
      
<link rel="stylesheet" href="/css/heading-numbering.css">

      
<script src="/js/heading-numbering.js"></script>

    
    
    <!-- 三线表样式 -->
    
      
<link rel="stylesheet" href="/css/three-line-table.css">

    
  
    <!-- 图片样式 -->
    
      
<link rel="stylesheet" href="/css/image-handler.css">

      
<script src="/js/image-handler.js"></script>

    
    
  
    
<link rel="stylesheet" href="/css/root.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/post.css">


    <!-- 代码块基础样式 -->
    
<link rel="stylesheet" href="/css/code-block-base.css">

  
    <!-- Codeblock Theme Toggler CSS -->
    
    
<link rel="stylesheet" href="/css/codeblock-theme-toggle.css">

    
  
    <!-- Codeblock Mac Enhancer CSS -->
    
    
<link rel="stylesheet" href="/css/code-block-mac-enhancer.css">

    
  
    <!-- TOC 样式 -->
    <link rel="stylesheet" href="/css/toc.css">
    
  <!-- hexo injector head_end start -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
  <!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0">
</head>


    <div class="site-container">
      <!-- 导航栏 -->
      <!--(头部 top bar) Header 样式 -->

<link rel="stylesheet" href="/css/header.css">


<header class="header">
  <section class="header-container">
    <a class="header-logo" href="/">Kytolly&#39;s Blog</a>
    <div class="header-right-section">
      <ul class="header-nav">
        
        <li>
          <a href="/">
            <img src="/icon/index.svg" alt="index icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            index
          </a>
        </li>
        
        <li>
          <a href="/archive">
            <img src="/icon/archive.svg" alt="archive icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            archive
          </a>
        </li>
        
        <li>
          <a href="/tag">
            <img src="/icon/tag.svg" alt="tag icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            tag
          </a>
        </li>
        
        <li>
          <a href="/about">
            <img src="/icon/about.svg" alt="about icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            about
          </a>
        </li>
        
      </ul>
      
      
      <div class="header-search-container search-trigger">
        <img src="/icon/search.svg" alt="Search Icon" class="search-icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
        <input type="text" id="header-search-input" placeholder="searching..." readonly>
      </div>
      
    </div>
  </section>
</header>


<script src="/js/search.js"></script>


      <!-- 路由 根据页面类型决定渲染内容 -->
      <main class="main">
  
    <article class="post-container">
  <!-- 可选：左侧跟随目录 -->
  
  <aside id="toc-container" class="toc-container toc-left toc-expanded">
    <div id="toc-title" class="toc-title">存储管理</div>
    <div id="toc-content" class="toc-content">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%AE%E7%9A%84"><span class="toc-number">1.</span> <span class="toc-text">目的</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD"><span class="toc-number">2.</span> <span class="toc-text">基本功能</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86%E5%9F%BA%E7%A1%80"><span class="toc-number"></span> <span class="toc-text">编译原理基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E5%92%8C%E7%A9%BA%E9%97%B4"><span class="toc-number">1.</span> <span class="toc-text">地址和空间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E6%8E%A5"><span class="toc-number">2.</span> <span class="toc-text">链接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%85%E5%85%A5"><span class="toc-number">3.</span> <span class="toc-text">装入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9C%80%E6%B1%82"><span class="toc-number"></span> <span class="toc-text">需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%EF%BC%88%E5%86%85%E5%AD%98%E5%88%86%E5%8C%BA%EF%BC%89"><span class="toc-number"></span> <span class="toc-text">内存分配（内存分区）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E7%BB%AD%E5%88%86%E9%85%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">连续分配方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9E%E7%BB%AD%E5%88%86%E9%85%8D"><span class="toc-number">1.1.</span> <span class="toc-text">连续分配</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E5%8C%BA%E7%AE%A1%E7%90%86"><span class="toc-number">1.1.1.</span> <span class="toc-text">分区管理</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9B%BA%E5%AE%9A%E5%88%86%E5%8C%BA"><span class="toc-number">1.1.2.</span> <span class="toc-text">固定分区</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E5%88%86%E5%8C%BA"><span class="toc-number">1.1.3.</span> <span class="toc-text">动态分区</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BC%99%E4%BC%B4%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.4.</span> <span class="toc-text">伙伴系统</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E6%89%A9%E5%85%85"><span class="toc-number">1.2.</span> <span class="toc-text">内存扩充</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A6%86%E7%9B%96overlay"><span class="toc-number">1.2.1.</span> <span class="toc-text">覆盖overlay</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%A4%E6%8D%A2swapping"><span class="toc-number">1.2.2.</span> <span class="toc-text">交换swapping</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A6%BB%E6%95%A3%E5%88%86%E9%85%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">2.</span> <span class="toc-text">离散分配方式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98"><span class="toc-number">2.1.</span> <span class="toc-text">解决问题</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%8D%95%E4%BD%8D"><span class="toc-number">2.2.</span> <span class="toc-text">基本单位</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E9%A1%B5%E5%BC%8F%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">2.3.</span> <span class="toc-text">分页式存储管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E6%AE%B5%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">2.4.</span> <span class="toc-text">分段存储管理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AE%B5%E9%A1%B5%E5%BC%8F%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">2.5.</span> <span class="toc-text">段页式存储管理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E6%96%B9%E5%BC%8F"><span class="toc-number">3.</span> <span class="toc-text">虚拟存储方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98"><span class="toc-number"></span> <span class="toc-text">虚拟内存</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A1%AC%E4%BB%B6%E5%92%8C%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.</span> <span class="toc-text">硬件和控制结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%90%86%E8%AE%BA%E4%BE%9D%E6%8D%AE"><span class="toc-number">1.1.</span> <span class="toc-text">理论依据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E5%99%A8"><span class="toc-number">1.2.</span> <span class="toc-text">虚拟存储器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E9%A1%B5%E8%A1%A8"><span class="toc-number">1.3.</span> <span class="toc-text">二级页表</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BF%AB%E8%A1%A8TLB"><span class="toc-number">1.4.</span> <span class="toc-text">快表TLB</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E8%BD%AF%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">操作系统软件</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%A1%B5%E8%A1%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">2.1.</span> <span class="toc-text">页表机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E9%A1%B5%E4%B8%AD%E6%96%AD%E6%9C%BA%E5%88%B6"><span class="toc-number">2.2.</span> <span class="toc-text">缺页中断机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BD%AE%E6%8D%A2%E7%AD%96%E7%95%A5"><span class="toc-number">2.3.</span> <span class="toc-text">置换策略</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A6%82%E5%BF%B5"><span class="toc-number">2.3.1.</span> <span class="toc-text">概念</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB"><span class="toc-number">3.</span> <span class="toc-text">分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E8%B0%83%E5%85%A5"><span class="toc-number">3.0.1.</span> <span class="toc-text">页面调入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E6%8D%A2%E5%87%BA"><span class="toc-number">3.0.2.</span> <span class="toc-text">页面换出</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2"><span class="toc-number">3.0.3.</span> <span class="toc-text">页面置换</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95"><span class="toc-number">4.</span> <span class="toc-text">置换算法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E4%BC%98%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95OPT"><span class="toc-number">4.1.</span> <span class="toc-text">最优置换算法OPT</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%88%E8%BF%9B%E5%85%88%E5%87%BA%E7%AE%97%E6%B3%95FIFO"><span class="toc-number">4.2.</span> <span class="toc-text">先进先出算法FIFO</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%80%E8%BF%91%E6%9C%80%E4%B9%85%E6%9C%AA%E4%BD%BF%E7%94%A8%E7%AE%97%E6%B3%95LRU"><span class="toc-number">4.3.</span> <span class="toc-text">最近最久未使用算法LRU</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%97%B6%E9%92%9F%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95CLOCK-Not-Recently-Used"><span class="toc-number">4.4.</span> <span class="toc-text">时钟置换算法CLOCK Not Recently Used</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E9%A1%B5%E7%8E%87"><span class="toc-number">5.</span> <span class="toc-text">缺页率</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E9%9B%86"><span class="toc-number">6.</span> <span class="toc-text">工作集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%96%E5%8A%A8-%E9%A2%A0%E7%B0%B8thrashing"><span class="toc-number">7.</span> <span class="toc-text">抖动&#x2F;颠簸thrashing</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E5%88%86%E9%A1%B5%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">请求分页存储管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">8.1.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-number">8.2.</span> <span class="toc-text">缺点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">8.3.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%AE%B5%E8%A1%A8%E6%9C%BA%E5%88%B6"><span class="toc-number">8.4.</span> <span class="toc-text">段表机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E6%AE%B5%E4%B8%AD%E6%96%AD"><span class="toc-number">8.5.</span> <span class="toc-text">缺段中断</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">8.6.</span> <span class="toc-text">地址转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5-%E9%93%BE%E6%8E%A5%E4%B8%AD%E6%96%AD"><span class="toc-number">8.7.</span> <span class="toc-text">动态链接&amp;链接中断</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AE%B5%E9%A1%B5%E5%BC%8F%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E6%8A%80%E6%9C%AF"><span class="toc-number">9.</span> <span class="toc-text">段页式虚拟存储技术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E5%92%8C%E4%BF%9D%E6%8A%A4"><span class="toc-number">10.</span> <span class="toc-text">共享和保护</span></a></li></ol>
    </div>
  </aside>
 


<script src="/js/toc.js"></script>


  <!-- 可选：右侧 AI 摘要 -->
  

  <div class="post-main-wrapper">
    <!-- 文章 -->
    <div class="post-title">存储管理</div>
  <div class="post-meta">
    <div class="date">2025 七月 5日</div>
    <div class="tags">
      
        
        <div class="tag-item">Coursework</div>
        
        <div class="tag-item">System</div>
        
      
    </div>
  </div>

<main class="post-content"><h3 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h3>
<p>为多道程序的运行提供良好的环境</p>
<ul>
<li>方便用户使用存储器</li>
<li>提高存储器的利用率</li>
<li>逻辑上扩充存储器容量</li>
</ul>
<h3 id="基本功能"><a href="#基本功能" class="headerlink" title="基本功能"></a>基本功能</h3>
<ul>
<li>存储分配和回收</li>
<li>地址变换</li>
<li>存储保护</li>
<li>存储共享</li>
<li>存储器扩充</li>
</ul>
<h2 id="编译原理基础"><a href="#编译原理基础" class="headerlink" title="编译原理基础"></a>编译原理基础</h2>
<p>源代码转化成进程的三个步骤</p>
<ul>
<li>编译compile：由编译程序将用户源代码编译成若干个目标模块</li>
<li>链接linking：由链接程序将编译后形成的一组目标模块，以及所需要的苦函数链接在一起</li>
<li>装入loading：由装入程序将装入模块装入到物理内存中</li>
</ul>
<h3 id="地址和空间"><a href="#地址和空间" class="headerlink" title="地址和空间"></a>地址和空间</h3>
<p><strong>名空间</strong>：高级语言常常用符号名来访问某一个单元，将程序中由符号名组成的程序空间称作符号名空间
<strong>逻辑空间</strong>：源程序经过编译后形成目标程序，这个程序按照0为基址为顺序进行编址，原先用符号名访问的单元用单元号代替，这样目标程序占据一定的地址空间叫做逻辑地址空间
<strong>逻辑地址</strong>：在逻辑空间中每条指令的地址和指令要访问的操作数地址统称为逻辑地址
<strong>内存地址</strong>：内存中每个存储单元都有一个编号，称作内存地址
<strong>物理空间</strong>：所有内存地址构成的集合称为内存空间/物理空间,可进行一维线性地编号
<strong>地址映射</strong>Mapping：将逻辑地址转换为运行时由机器寻址的物理地址
<img src="/assets/Operate-System/498f9f12a3a9b94d372446ebe7591dbd.png" alt="498f9f12a3a9b94d372446ebe7591dbd"></p>
<h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a>链接</h3>
<p>源程序经过编译后得到一组目标模块，再利用链接程序将这组目标模块链接形成装入模块</p>
<ul>
<li>静态链接：程序运行前，将各个目标模块和他们所需的库函数，链接成一个完整的装配模块之后不再拆开
<ul>
<li>相对地址的修改：每个其实模块用到相对地址，起始地址为0，链接成一个装入模块时要修改成模块的相对地址</li>
<li>变换外部引用地址：外部调用符号也相应地变换相对地址</li>
<li>缺点：不利于代码共享，不利于模块的独立升级，也可能链接不会执行的模块浪费存储空间和处理机时间</li>
</ul>
</li>
<li>装入时动态链接：装入一个目标模块时，若发生一个外部模块调用时间，将引起装入程序去找出相应的外部模块，装入内存并修改模块的相对地址
<ul>
<li>优点：利于模块的独立升级和模块的共享</li>
<li>缺点：可能链接不会执行的模块，装入后不能移动位置</li>
</ul>
</li>
<li>运行时动态链接：对某些目标模块的链接，是在程序执行中需要该目标模块时 ，由操作系统去找到该模块并将之装入内存，随后把它链接到调用者模块上
<ul>
<li>优点：凡在执行过程中未被用到的目标模块，都不会被调入内存和 被链接到装入模块上，这样不仅可加快程序的装入过程，而且可 节省大量的内存空间。</li>
</ul>
</li>
</ul>
<h3 id="装入"><a href="#装入" class="headerlink" title="装入"></a>装入</h3>
<p>将可装入模块装入内存</p>
<p>地址重定位：将可执行文件的逻辑地址转化为内存物理地址的过程</p>
<ul>
<li>绝对装入方式
<ul>
<li>在编译时就知道程序将驻留在内存中的具体位置，编译 程序产生绝对地址的目标代码</li>
<li>优点：实现简单，无须进行逻辑地址到物理地址的变换</li>
<li>缺点：程序每次必须装入同一内存区，程序员必须事先了解内存的使用情况，根据内存情况确定 程序的逻辑地址，不适于多道程序系统</li>
</ul>
</li>
<li>可重定位（静态重定位）方式
<ul>
<li>编译时采用相对地址，即编译器假设是装入到从零开始的 内存位置</li>
<li>优点：易实现，无需硬件支持</li>
<li>缺点：程序重定位后就不能移动，因而不能重新分配内存，不利于内存的有效利用，程序在存储空间中只能连续分配，不能分布在内存的不同 区域，难于共享</li>
</ul>
</li>
<li>运行时重定位（动态重定位）装入方式
<ul>
<li>程序的地址转换不是在装入时进行，而是在程序运行时动态 进行，需要<strong>硬件支持</strong>，即重定位寄存器，用于保存 程序在内存中的起始地址，是实现装入的主流方式</li>
<li>优点：程序不必连续存放在内存中，可分散存储，可移动；便于共享；对于存储器紧缩、解决碎片问题极其有利</li>
<li>缺点：需要硬件支持，实现存储管理的软件算法比较复杂；同一地址，可能多次转换。</li>
</ul>
</li>
</ul>
<h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2>
<p>在单道程序设计中，内存的使用目的：</p>
<ul>
<li>供操作系统使用：驻留监控程序，内核</li>
<li>供当前正在执行的程序使用</li>
</ul>
<p>在多道程序设计中，必须作进一步细分，由于处理器长期空闲，因此必须有效分配内存来保证适当数量的就绪进程可以占用这些可用的处理器时间；</p>
<p>内存管理的功能需求</p>
<ul>
<li>重定位：进程在内存中进出，放置于不同位置的能力</li>
<li>保护：保护进程的程序和数据不被未授权的进程访问和修改</li>
<li>共享：不损害基本保护的前提下，必须对内存的共享区域进行受控访问</li>
<li>逻辑组织：利于系统和硬件能有效地处理某种某块形式组织的用户程序和数据</li>
<li>物理组织：计算机存储器的两级划分（内存和外存）的移动信息应该由系统负责；</li>
</ul>
<h2 id="内存分配（内存分区）"><a href="#内存分配（内存分区）" class="headerlink" title="内存分配（内存分区）"></a>内存分配（内存分区）</h2>
<p>内存分配包括以下：</p>
<ul>
<li>连续分配：单一连续分配，涉及分区管理，内存扩充（覆盖和对换）</li>
<li>离散分配：涉及对分页式，段式和段页式存储管理</li>
<li>虚拟存储器：涉及请求分页存储，请求分段和段页式虚拟存储</li>
</ul>
<h3 id="连续分配方式"><a href="#连续分配方式" class="headerlink" title="连续分配方式"></a>连续分配方式</h3>
<h4 id="连续分配"><a href="#连续分配" class="headerlink" title="连续分配"></a>连续分配</h4>
<p>原理：内存划分为系统区和用户区，整个用户区分配一个进程</p>
<p>适用场合：最简单，适合当用户和单任务OS</p>
<p>优点：易于管理</p>
<p>缺点：造成空间的浪费</p>
<h5 id="分区管理"><a href="#分区管理" class="headerlink" title="分区管理"></a>分区管理</h5>
<p>原理：将内存分为一些大小相等或不等的分区，每个应用进程个占用若干个分区，操作系统占用一个分区</p>
<p>特点：适用于多道程序系统和分时系统</p>
<p><strong>内部碎片</strong>：占用<strong>分区之内</strong>未被利用的空间</p>
<p><strong>外部碎片</strong>：占用<strong>分区之间</strong>难以利用的空闲分区</p>
<h5 id="固定分区"><a href="#固定分区" class="headerlink" title="固定分区"></a>固定分区</h5>
<p>原理：将内存划分为大小相等或不等的分区，在每个分区只装入一道程序，分区的划分有OS决定，一旦划分结束，总分区个数保持不变</p>
<p>特点</p>
<ul>
<li>适用于多道程序系统和分时系统</li>
<li>支持多个进程并发执行</li>
</ul>
<p>问题</p>
<ul>
<li>程序可能太大装不到一个分区</li>
<li>内存利用率可能很低，程序小可能也要占用一个分区，形成内部碎片现象；</li>
</ul>
<p>划分方法：分区大小相同/分区多种大小</p>
<p>分区描述表：通常将<strong>分区按大小排队</strong>，标明起始地址和分配状态，建立分区描述表</p>
<p>分配算法</p>
<ul>
<li>对于分区大小相同：使用哪个分区都没关系</li>
<li>对于分区大小不同：最佳匹配（为空闲分区选择最佳任务/根据任务选择最佳空闲分区），或者最坏匹配</li>
</ul>
<p>存储保护：防止某个作业破坏系统或者其他作业，通常采用界限寄存器实现，每个寄存器都对应两个代表上下限的寄存器用于越界保护；</p>
<p>优点</p>
<ul>
<li>比单一连续分配方法，提高内存的利用率</li>
<li>可以支持多道程序，无外部碎片</li>
<li>实现简单</li>
</ul>
<p>缺点</p>
<ul>
<li>分区数目在系统生成时确定，限制系统中活跃进程的数目；</li>
<li>小作业的内部碎片可能比较大；</li>
<li>作业必须要预先估计自己要占用多大空间；</li>
</ul>
<h5 id="动态分区"><a href="#动态分区" class="headerlink" title="动态分区"></a>动态分区</h5>
<p>根据进程的实际需要，动态地分配内存空间，因此动态分区的长度和数量是可变的；</p>
<p>使用动态分区的方式，需要维护：</p>
<ul>
<li>空闲分区表：记录每个空闲分区的情况；</li>
<li>空闲分区链：通过指针的迭代拼接称双向链；</li>
</ul>
<p>分配算法</p>
<ul>
<li>首次匹配算法First Fit
<ul>
<li>要求空闲分区链以地址地震的次序链接，在分配内存时，从链首开始顺序查找，知道一个大小满足要求的空闲分区为止；</li>
<li>为大作业分配大的内存空间创造了条件</li>
<li>低地址空间不断被划分，留下难以利用的小空闲分区，增加查找查找开销</li>
</ul>
</li>
<li>循环匹配算法Next Fit
<ul>
<li>为空闲分区构成循环链表，采用循环查找方式，设置一个开始查寻指针，用于指示下一次起始查询的空闲分区</li>
<li>使得内存空闲分布更均匀，减小查找开销</li>
<li>缺乏大的空闲分区</li>
<li>空闲分区应该按照<strong>地址</strong>顺序排列</li>
</ul>
</li>
<li>最佳匹配算法Best Fit
<ul>
<li>每次分配内存时，总是能把满足要求又是最小的空闲分区分配给作业</li>
<li>产生的外部碎片小</li>
<li>碎片太小往往难以利用，造成浪费</li>
<li>按容量从小到大排列</li>
</ul>
</li>
<li>最坏适应算法Worst Fit
<ul>
<li>每次满足要求又是最大的空闲分区给作业</li>
<li>留下的空闲分区很大方便下一次利用</li>
<li>不利于大作业</li>
<li>按容量从大到小排列</li>
</ul>
</li>
</ul>
<p>分区管理</p>
<ul>
<li>分配：按照算法选择空闲分区，并在空闲分区表删除，添加新产生的空闲分区</li>
<li>回收：当进程运行完毕释放内存时，需合并相邻的空闲分区，形成大的分区</li>
<li>紧凑和动态重定位：将内存中的所有作业进行移动，使它们全都 相邻接，这样，可把原来分散的多个小分区合成一个大分区</li>
</ul>
<p>存储保护：上、下界寄存器方法/基址、限长寄存器方法2</p>
<p>优点</p>
<ul>
<li>支持多道程序</li>
<li>管理方案简单，不需要更多的软硬件开销</li>
<li>实现存储保护的手段比较简单</li>
</ul>
<p>缺点</p>
<ul>
<li>主存利用不够充分</li>
<li>无法实现多进程共享存储器的信息（不是分段内存分配都无法实现）</li>
<li>无法实现主村的逻辑扩充，进程的地址空间受物理内存的限制</li>
</ul>
<h5 id="伙伴系统"><a href="#伙伴系统" class="headerlink" title="伙伴系统"></a>伙伴系统</h5>
<p>伙伴系统是固定分区和动态分区的折中方案；</p>
<p>设计可用的内存块大小为<svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="14.402ex" height="2.497ex" role="img" focusable="false" viewBox="0 -853.7 6365.5 1103.7" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-1-TEX-I-1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z"></path><path id="MJX-1-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-1-TEX-I-1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-1-TEX-N-2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path><path id="MJX-1-TEX-I-1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path><path id="MJX-1-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-1-TEX-N-32"></use></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><use data-c="1D458" xlink:href="#MJX-1-TEX-I-1D458"></use></g></g><g data-mml-node="mo" transform="translate(951.4,0)"><use data-c="28" xlink:href="#MJX-1-TEX-N-28"></use></g><g data-mml-node="mi" transform="translate(1340.4,0)"><use data-c="1D43F" xlink:href="#MJX-1-TEX-I-1D43F"></use></g><g data-mml-node="mo" transform="translate(2299.2,0)"><use data-c="2264" xlink:href="#MJX-1-TEX-N-2264"></use></g><g data-mml-node="mi" transform="translate(3355,0)"><use data-c="1D458" xlink:href="#MJX-1-TEX-I-1D458"></use></g><g data-mml-node="mo" transform="translate(4153.7,0)"><use data-c="2264" xlink:href="#MJX-1-TEX-N-2264"></use></g><g data-mml-node="mi" transform="translate(5209.5,0)"><use data-c="1D448" xlink:href="#MJX-1-TEX-I-1D448"></use></g><g data-mml-node="mo" transform="translate(5976.5,0)"><use data-c="29" xlink:href="#MJX-1-TEX-N-29"></use></g></g></g></svg>字节，整个分配空间被视为<svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="2.546ex" height="1.914ex" role="img" focusable="false" viewBox="0 -846 1125.4 846" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-2-TEX-I-1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><use data-c="1D448" xlink:href="#MJX-2-TEX-I-1D448"></use></g></g></g></g></svg>的块；</p>
<p>对于进程申请<svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="12.959ex" height="2.326ex" role="img" focusable="false" viewBox="0 -833.9 5727.7 1027.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-3-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-3-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-3-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-3-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-3-TEX-N-3C" d="M694 -11T694 -19T688 -33T678 -40Q671 -40 524 29T234 166L90 235Q83 240 83 250Q83 261 91 266Q664 540 678 540Q681 540 687 534T694 519T687 505Q686 504 417 376L151 250L417 124Q686 -4 687 -5Q694 -11 694 -19Z"></path><path id="MJX-3-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-3-TEX-N-2264" d="M674 636Q682 636 688 630T694 615T687 601Q686 600 417 472L151 346L399 228Q687 92 691 87Q694 81 694 76Q694 58 676 56H670L382 192Q92 329 90 331Q83 336 83 348Q84 359 96 365Q104 369 382 500T665 634Q669 636 674 636ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-3-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-3-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="2212" xlink:href="#MJX-3-TEX-N-2212"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use></g></g></g><g data-mml-node="mo" transform="translate(2008.4,0)"><use data-c="3C" xlink:href="#MJX-3-TEX-N-3C"></use></g><g data-mml-node="mi" transform="translate(3064.2,0)"><use data-c="1D45D" xlink:href="#MJX-3-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(3845,0)"><use data-c="2264" xlink:href="#MJX-3-TEX-N-2264"></use></g><g data-mml-node="msup" transform="translate(4900.7,0)"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-3-TEX-N-32"></use></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-3-TEX-I-1D456"></use></g></g></g></g></svg>的空间，可以用以下的递归算法找到大小为<svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.871ex" height="1.879ex" role="img" focusable="false" viewBox="0 -830.4 827 830.4" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-4-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-4-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-4-TEX-N-32"></use></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-4-TEX-I-1D456"></use></g></g></g></g></svg>的块；</p>
<ol>
<li>查找大小为<svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.871ex" height="1.879ex" role="img" focusable="false" viewBox="0 -830.4 827 830.4" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-5-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-5-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-5-TEX-N-32"></use></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-5-TEX-I-1D456"></use></g></g></g></g></svg>的空闲分区，若找到则分配；</li>
<li>若未找到大小为2i的空闲分区，则查找大小为<svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="3.915ex" height="1.887ex" role="img" focusable="false" viewBox="0 -833.9 1730.6 833.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-6-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-6-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-6-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-6-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-6-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-6-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="2B" xlink:href="#MJX-6-TEX-N-2B"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-6-TEX-N-31"></use></g></g></g></g></g></svg>的空闲分区 ；
<ul>
<li>若找到，则将该空闲分区划分为相等的两个分区（一对伙伴），其 中的一个用于分配，另一个分区加入大小为<svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.871ex" height="1.879ex" role="img" focusable="false" viewBox="0 -830.4 827 830.4" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-7-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-7-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msup"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-7-TEX-N-32"></use></g><g data-mml-node="mi" transform="translate(533,363) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-7-TEX-I-1D456"></use></g></g></g></g></svg>的空闲分区链中；</li>
</ul>
</li>
<li>以此类推</li>
</ol>
<h4 id="内存扩充"><a href="#内存扩充" class="headerlink" title="内存扩充"></a>内存扩充</h4>
<p>内存扩充：借助大容量辅存在逻辑上实现内存扩充，来解决内存容量不足的问题；
覆盖和交换：需要在较小可用内存运行较大的程序，在任何时候，只在内存中保留所需的指令和数据，当需要时，在从外存中写回内存</p>
<h5 id="覆盖overlay"><a href="#覆盖overlay" class="headerlink" title="覆盖overlay"></a>覆盖overlay</h5>
<p>基本思想:一个程序的几个代码段或数据段，按照时间先后来占用公共的内存空间。</p>
<p>实现：</p>
<ul>
<li>将程序的必要部分代码和数据常驻内存；</li>
<li>可选部分在其他程序模块中实现，平时存放在外存中（覆盖文件），需要用到时才装入到内存；</li>
<li>不存在调用关系的模块不必同时装入到内存，可相互覆盖</li>
</ul>
<h5 id="交换swapping"><a href="#交换swapping" class="headerlink" title="交换swapping"></a>交换swapping</h5>
<p>基本思想：把内存中展示不能运行的进程或者暂时不使用的程序和数据换出到外存上，以腾出足够的内存空间
粒度：</p>
<ul>
<li>进程交换：解决内存紧张问题，进一步提高内存利用率</li>
<li>页面交换，分段交换：可以支持虚拟存储系统</li>
</ul>
<p>管理：</p>
<ul>
<li>外存：对换区比文件区侧重于对换速度</li>
<li>对换区一般采用连续分配</li>
</ul>
<p>优点：</p>
<ul>
<li>换入和换出操作由内存管理模块，与程序结构无关</li>
</ul>
<h3 id="离散分配方式"><a href="#离散分配方式" class="headerlink" title="离散分配方式"></a>离散分配方式</h3>
<h4 id="解决问题"><a href="#解决问题" class="headerlink" title="解决问题"></a>解决问题</h4>
<p>一个进程的分配的内存由多个离散的空间组成</p>
<ul>
<li>固定分区存在内存碎片</li>
<li>动态分区存在外部碎片</li>
<li>可重定位动态分区的系统开销大</li>
</ul>
<h4 id="基本单位"><a href="#基本单位" class="headerlink" title="基本单位"></a>基本单位</h4>
<p>分页式存储管理</p>
<ul>
<li>页面：程序地址空间被划分为若干固定大小的片段</li>
<li>页框：物理内存被划分成相同大小的块</li>
</ul>
<p>分段存储管理</p>
<ul>
<li>以段为基本分配单位的存储管理方式</li>
</ul>
<p>段页式存储管理</p>
<ul>
<li>段内分页</li>
</ul>
<h4 id="分页式存储管理"><a href="#分页式存储管理" class="headerlink" title="分页式存储管理"></a>分页式存储管理</h4>
<p>存储管理系统负责用户空间，物理空间的划分编号；
以下是程序空间到物理空间的映射，程序的每一个页分散到物理空间的页；而从每一页看地址都是连续的；
<img src="/assets/Operate-System/image-20241029195523122.png" alt="image-20241029195523122">
<strong>逻辑地址结构转换物理地址</strong>
假设对于32位的机器，页面大小为<svg style="vertical-align: -0.186ex;" xmlns="http://www.w3.org/2000/svg" width="7.477ex" height="2.072ex" role="img" focusable="false" viewBox="0 -833.9 3304.7 915.9" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-8-TEX-I-1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-8-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-8-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-8-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D43F" xlink:href="#MJX-8-TEX-I-1D43F"></use></g><g data-mml-node="mo" transform="translate(958.8,0)"><use data-c="3D" xlink:href="#MJX-8-TEX-N-3D"></use></g><g data-mml-node="msup" transform="translate(2014.6,0)"><g data-mml-node="mn"><use data-c="32" xlink:href="#MJX-8-TEX-N-32"></use></g><g data-mml-node="TeXAtom" transform="translate(533,363) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mn"><use data-c="31" xlink:href="#MJX-8-TEX-N-31"></use><use data-c="32" xlink:href="#MJX-8-TEX-N-32" transform="translate(500,0)"></use></g></g></g></g></g></svg>，给定逻辑地址空间的地址为<svg style="vertical-align: 0;" xmlns="http://www.w3.org/2000/svg" width="1.697ex" height="1.62ex" role="img" focusable="false" viewBox="0 -716 750 716" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-9-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D434" xlink:href="#MJX-9-TEX-I-1D434"></use></g></g></g></svg></p>
<ul>
<li>页号<svg style="vertical-align: -0.781ex;" xmlns="http://www.w3.org/2000/svg" width="8.921ex" height="2.817ex" role="img" focusable="false" viewBox="0 -900.3 3942.9 1245.3" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-10-TEX-I-1D443" d="M287 628Q287 635 230 637Q206 637 199 638T192 648Q192 649 194 659Q200 679 203 681T397 683Q587 682 600 680Q664 669 707 631T751 530Q751 453 685 389Q616 321 507 303Q500 302 402 301H307L277 182Q247 66 247 59Q247 55 248 54T255 50T272 48T305 46H336Q342 37 342 35Q342 19 335 5Q330 0 319 0Q316 0 282 1T182 2Q120 2 87 2T51 1Q33 1 33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM645 554Q645 567 643 575T634 597T609 619T560 635Q553 636 480 637Q463 637 445 637T416 636T404 636Q391 635 386 627Q384 621 367 550T332 412T314 344Q314 342 395 342H407H430Q542 342 590 392Q617 419 631 471T645 554Z"></path><path id="MJX-10-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-10-TEX-N-230A" d="M174 734Q174 735 175 737T177 740T180 744T184 747T189 749T196 750Q206 748 214 735V-210H310H373Q401 -210 411 -213T422 -230T411 -247T369 -251Q362 -251 338 -251T298 -250H190Q178 -246 174 -234V734Z"></path><path id="MJX-10-TEX-I-1D434" d="M208 74Q208 50 254 46Q272 46 272 35Q272 34 270 22Q267 8 264 4T251 0Q249 0 239 0T205 1T141 2Q70 2 50 0H42Q35 7 35 11Q37 38 48 46H62Q132 49 164 96Q170 102 345 401T523 704Q530 716 547 716H555H572Q578 707 578 706L606 383Q634 60 636 57Q641 46 701 46Q726 46 726 36Q726 34 723 22Q720 7 718 4T704 0Q701 0 690 0T651 1T578 2Q484 2 455 0H443Q437 6 437 9T439 27Q443 40 445 43L449 46H469Q523 49 533 63L521 213H283L249 155Q208 86 208 74ZM516 260Q516 271 504 416T490 562L463 519Q447 492 400 412L310 260L413 259Q516 259 516 260Z"></path><path id="MJX-10-TEX-I-1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-10-TEX-N-230B" d="M229 734Q229 735 230 737T232 740T235 744T239 747T244 749T251 750Q262 748 269 735V-235Q266 -240 256 -249L147 -250H77Q43 -250 32 -247T21 -230T32 -213T72 -209Q79 -209 99 -209T133 -210H229V734Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D443" xlink:href="#MJX-10-TEX-I-1D443"></use></g><g data-mml-node="mo" transform="translate(1028.8,0)"><use data-c="3D" xlink:href="#MJX-10-TEX-N-3D"></use></g><g data-mml-node="mo" transform="translate(2084.6,0)"><use data-c="230A" xlink:href="#MJX-10-TEX-N-230A"></use></g><g data-mml-node="mfrac" transform="translate(2528.6,0)"><g data-mml-node="mi" transform="translate(220,394) scale(0.707)"><use data-c="1D434" xlink:href="#MJX-10-TEX-I-1D434"></use></g><g data-mml-node="mi" transform="translate(244.4,-345) scale(0.707)"><use data-c="1D43F" xlink:href="#MJX-10-TEX-I-1D43F"></use></g><rect width="730.3" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(3498.9,0)"><use data-c="230B" xlink:href="#MJX-10-TEX-N-230B"></use></g></g></g></svg>：12-31位</li>
<li>页内偏移量<svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="9.129ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 4035.2 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-11-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-11-TEX-N-2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z"></path><path id="MJX-11-TEX-N-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path id="MJX-11-TEX-N-30" d="M96 585Q152 666 249 666Q297 666 345 640T423 548Q460 465 460 320Q460 165 417 83Q397 41 362 16T301 -15T250 -22Q224 -22 198 -16T137 16T82 83Q39 165 39 320Q39 494 96 585ZM321 597Q291 629 250 629Q208 629 178 597Q153 571 145 525T137 333Q137 175 145 125T181 46Q209 16 250 16Q290 16 318 46Q347 76 354 130T362 333Q362 478 354 524T321 597Z"></path><path id="MJX-11-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-11-TEX-I-1D43F" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path id="MJX-11-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-11-TEX-I-1D451"></use></g><g data-mml-node="mo" transform="translate(797.8,0)"><use data-c="2208" xlink:href="#MJX-11-TEX-N-2208"></use></g><g data-mml-node="mo" transform="translate(1742.6,0)"><use data-c="5B" xlink:href="#MJX-11-TEX-N-5B"></use></g><g data-mml-node="mn" transform="translate(2020.6,0)"><use data-c="30" xlink:href="#MJX-11-TEX-N-30"></use></g><g data-mml-node="mo" transform="translate(2520.6,0)"><use data-c="2C" xlink:href="#MJX-11-TEX-N-2C"></use></g><g data-mml-node="mi" transform="translate(2965.2,0)"><use data-c="1D43F" xlink:href="#MJX-11-TEX-I-1D43F"></use></g><g data-mml-node="mo" transform="translate(3646.2,0)"><use data-c="29" xlink:href="#MJX-11-TEX-N-29"></use></g></g></g></svg>：0-11位</li>
</ul>
<p>对于16位的机器而言，页号占6位，页内偏移量占10位；</p>
<p>页表则维护每个页面对应的页框信息，即页号和段号的映射</p>
<ul>
<li>存储在内存</li>
<li>PCB保存页表的起始地址</li>
<li>快表：对页表的使用频度高表项用高速缓存器存储</li>
</ul>
<p>优点：</p>
<ul>
<li>存在页内碎片，但是碎片小，内存利用率高</li>
<li>实现了离散分配</li>
<li>无外部碎片</li>
</ul>
<p>缺点：</p>
<ul>
<li>需要专门的硬件支持，尤其是快表</li>
<li>不支持动态链接，不易共享</li>
</ul>
<h4 id="分段存储管理"><a href="#分段存储管理" class="headerlink" title="分段存储管理"></a>分段存储管理</h4>
<p>引入原因：</p>
<ul>
<li>更自然组织信息：通过段名访问程序段和数据段</li>
<li>信息共享和共享：段是信息的逻辑单位，页只是存放信息的物理单位</li>
<li>动态增长：数据段事先无法知道大小</li>
<li>支持运行时动态链接</li>
</ul>
<p>组织方式</p>
<ul>
<li>段：定义一组逻辑信息，段+段内偏移量</li>
</ul>
<p>对于32位的机器，段号：24-31位，段内偏移量：0-23位</p>
<ul>
<li>从0开始编址</li>
<li>长度：由段定义的逻辑信息决定</li>
<li>每个逻辑段庄在到一段动态内存区域</li>
</ul>
<p>段表：记录逻辑段和物理段的对应情况
段号+段长+段首址+控制信息</p>
<ul>
<li>段表寄存器中存放段表的起始地址和段表长度</li>
<li>检查段号和段内偏移量越界：非法产生越界错误</li>
<li>检查访问控制字段：确定是否合法</li>
</ul>
<p><img src="/assets/Operate-System/image-20241029195650804.png" alt="image-20241029195650804"></p>
<p>优点：</p>
<ul>
<li>便于模块化设计</li>
<li>便于动态链接</li>
<li>便于共享与保护</li>
<li>无内部碎片</li>
</ul>
<p>缺点：</p>
<ul>
<li>地址转换需要硬件支持（段表寄存器）</li>
<li>分段最大尺寸受主存可用空间的限制</li>
<li>有外部碎片</li>
</ul>
<h4 id="段页式存储管理"><a href="#段页式存储管理" class="headerlink" title="段页式存储管理"></a>段页式存储管理</h4>
<p>分段和分页的比较</p>
<table>
<thead>
<tr>
<th>方面</th>
<th>分页</th>
<th>分段</th>
</tr>
</thead>
<tbody>
<tr>
<td>从设计目的来看</td>
<td>页是信息的物理单位，分页的目的是实现离散分配，减少内存的外部碎片，提高内存的利用率。或者说，分页仅仅是由于系统管理的需要而不是用户的需要。</td>
<td>段则是信息的逻辑单位，它含有一组意义相对完整的信息。分段的目的是为了能更好地满足用户的需要。</td>
</tr>
<tr>
<td>从系统实现上看</td>
<td>页的大小固定且由系统决定，由系统把逻辑地址划分为页号和页内地址两部分，是由机器硬件实现的，因而在系统中只能有一种大小的页面；</td>
<td>而段的长度却不固定，决定于用户所编写的程序，通常由编译程序在对源程序进行编译时，根据信息的性质来划分。</td>
</tr>
<tr>
<td>从功能实现上看</td>
<td>不易共享和运行时动态链接</td>
<td>易于共享和运行时动态链接</td>
</tr>
<tr>
<td>从编址方式来看</td>
<td>分页的作业地址空间是一维的，即单一的线性地址空间，程序员只需利用一个记忆符，即可表示一个地址；</td>
<td>分段的作业地址空间则是二维的，程序员在标识一个地址时，既需给出段名，又需给出段内地址。</td>
</tr>
</tbody>
</table>
<p>段页式存储管理</p>
<ul>
<li><strong>采用分段方法组织用户程序</strong>，用户程序采用模块化设计，用若干段划分</li>
<li><strong>采用分页方法分配和管理内存</strong>，内存分成若干页框，程序每个段风格成若干页后装入内存</li>
</ul>
<p>逻辑地址：段号s+段内页号p+页内偏移量w</p>
<ul>
<li>检查段号，段表访问控制字段，页号是否越界</li>
<li>页内偏移量送入物理地址的低端</li>
</ul>
<p><img src="/assets/Operate-System/image-20241029195722276.png" alt="image-20241029195722276"></p>
<p>优点</p>
<ul>
<li>离散存储</li>
<li>内存利用率高</li>
<li>便于保护和共享，支持动态链接</li>
<li>无外部碎片</li>
</ul>
<p>缺点</p>
<ul>
<li>地址转换复杂</li>
<li>有内部碎片</li>
</ul>
<h3 id="虚拟存储方式"><a href="#虚拟存储方式" class="headerlink" title="虚拟存储方式"></a>虚拟存储方式</h3>
<p>虚拟存储方式由虚拟内存机制实现</p>
<h2 id="虚拟内存"><a href="#虚拟内存" class="headerlink" title="虚拟内存"></a>虚拟内存</h2>
<h3 id="硬件和控制结构"><a href="#硬件和控制结构" class="headerlink" title="硬件和控制结构"></a>硬件和控制结构</h3>
<h4 id="理论依据"><a href="#理论依据" class="headerlink" title="理论依据"></a>理论依据</h4>
<p>常规的存储管理技术：</p>
<ul>
<li>一次性：需要作业全部装入内存运行</li>
<li>驻留性：作业装入内存后，一直驻留内存直到作业结束</li>
<li>难以满足大作业运行需求和大量作业并发，对于已装入内存的代码利用率低</li>
</ul>
<p>程序的<strong>局部性原理</strong>：在一段较短时间内，程序的执行仅局限于某个部分，相应地访问的存储空间也局限于某个区域</p>
<ul>
<li>时间局限性：下一次指令执行，数据访问集中在较短时间内;</li>
<li>空间局限性：下一次执行指令，数据访问集中在较小的区域；</li>
</ul>
<p>程序运行特点：</p>
<ul>
<li>大部分时间顺序执行</li>
<li>即使有跳转，也仍局限在某些函数下</li>
<li>许多循环结构下，少量指令多次执行</li>
<li>对数据结构的操作往往局限于小范围</li>
</ul>
<p>虚拟内存方案：</p>
<ul>
<li>将当前要执行的部分页/段读入内存，就可以运行程序</li>
<li>缺页/段时，处理器临时通知；</li>
<li>暂不使用的页/段换出内存；</li>
</ul>
<p>这表明虚拟内存方案是可行的；</p>
<h4 id="虚拟存储器"><a href="#虚拟存储器" class="headerlink" title="虚拟存储器"></a>虚拟存储器</h4>
<p>功能：</p>
<ul>
<li>请求调入和置换：从逻辑上对内存容量加以扩充</li>
<li>总容量由内存容量和外存容量之和决定</li>
<li>运行速度接近内存，位成本接近外存</li>
</ul>
<p>特征</p>
<ul>
<li>离散性:程序在内存中离散存放</li>
<li>局部性:进程无需全部驻留内存,只需载入必要的进程空间</li>
<li>对换性:允许进程在运行过程中换入、换出</li>
<li>虚拟性:能够从逻辑上扩充内存容量,使用户所看到的内存远大于内存容量</li>
</ul>
<p>硬件支持：</p>
<ul>
<li>相当数量的外存</li>
<li>一定容量的内存</li>
<li>请求分页或分段的页表或段表机制</li>
<li>缺页或缺段机构</li>
<li>地址变换机构</li>
</ul>
<p>常见技术</p>
<ul>
<li>请求分页存储管理</li>
<li>请求分段存储管理</li>
<li>请求段页式存储管理</li>
</ul>
<p>较小的页面有利于减少页内零头，但是可能导致页表过大，降低命中率；
较大的页面，内外存交换效率高，但是带来额外开销；
需要一种tradeoff机制；</p>
<h4 id="二级页表"><a href="#二级页表" class="headerlink" title="二级页表"></a>二级页表</h4>
<h4 id="快表TLB"><a href="#快表TLB" class="headerlink" title="快表TLB"></a>快表TLB</h4>
<p>原理：基于局部性原理，提高地址变换速度，为进程页表设置一个专用的高速缓冲存储器（Translation Lookaside Buffer）；</p>
<p>地址转换：</p>
<ol>
<li>分离提取页面号+页内偏移</li>
<li>检查页面号是否合法，非法报越界错误</li>
<li>根据页面号检索快表
<ul>
<li>若命中， 提取页框号，进入5；</li>
<li>若未命中，重新检索页表，结果载入快表，替换许久不用的表项</li>
</ul>
</li>
<li>检查访问控制字段，非法则报错</li>
<li>计算物理地址：页框<svg style="vertical-align: 0.02ex;" xmlns="http://www.w3.org/2000/svg" width="1.76ex" height="1.09ex" role="img" focusable="false" viewBox="0 -491 778 482" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-12-TEX-N-D7" d="M630 29Q630 9 609 9Q604 9 587 25T493 118L389 222L284 117Q178 13 175 11Q171 9 168 9Q160 9 154 15T147 29Q147 36 161 51T255 146L359 250L255 354Q174 435 161 449T147 471Q147 480 153 485T168 490Q173 490 175 489Q178 487 284 383L389 278L493 382Q570 459 587 475T609 491Q630 491 630 471Q630 464 620 453T522 355L418 250L522 145Q606 61 618 48T630 29Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="D7" xlink:href="#MJX-12-TEX-N-D7"></use></g></g></g></svg>页面大小+页内</li>
</ol>
<p>若<strong>页表存放在虚存</strong>中,则要实现一次页面访问需<strong>两次访问</strong> 物理内存  存</p>
<ul>
<li>第一次是访问页表,确定所存取页面的物理地址;</li>
<li>第二次根据该地址存取页面数据。</li>
</ul>
<h3 id="操作系统软件"><a href="#操作系统软件" class="headerlink" title="操作系统软件"></a>操作系统软件</h3>
<p>原理：</p>
<ul>
<li>建立在分页机制上：页面，页框和页表</li>
<li>请求调页和页面置换功能：部分页面载入内存，对换机制和将页面作为换入换出的基本单位</li>
</ul>
<h4 id="页表机制"><a href="#页表机制" class="headerlink" title="页表机制"></a>页表机制</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;页号&gt;&lt;页框号&gt;&lt;状态位P&gt;&lt;访问字段A&gt;&lt;修改位M&gt;&lt;外存地址&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>状态位：指示该页是否调入内存</li>
<li>访问字段：记录指定时间段的访问次数；</li>
<li>修改位：该页调入内存后是否被修改</li>
<li>外存地址：用于指出该页在外存上的地址</li>
</ul>
<h4 id="缺页中断机制"><a href="#缺页中断机制" class="headerlink" title="缺页中断机制"></a>缺页中断机制</h4>
<p>每当要访问的页面不在内存中，产生缺页中断，请求OS调入；</p>
<ul>
<li>在指令执行期间产生和处理中断信号；</li>
<li>一次指令执行期间，可能产生多次缺页中断；</li>
<li>带快表的基本分页地址：</li>
<li>缺页中断处理</li>
<li>页面换出
<img src="/assets/Operate-System/image-20241107111808996.png" alt="image-20241107111808996"><br>
<img src="/assets/Operate-System/image-20241107111829317.png" alt="image-20241107111829317"></li>
</ul>
<h4 id="置换策略"><a href="#置换策略" class="headerlink" title="置换策略"></a>置换策略</h4>
<h5 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h5>
<p>置换策略包括分配页面，调入页面和置换页面的内容</p>
<ul>
<li>分配页面：如何为每个进程分配页面</li>
<li>调入页面：何时调入页面，从哪调入页面和调入哪些页面</li>
<li>置换页面：交换区如何组织，换出页面的选择和换出实现</li>
</ul>
<h3 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h3>
<p>页面分配策略</p>
<ul>
<li>固定分配:进程分配到的物理块在进程运行期间不再改变</li>
<li>可变分配:进程运行期间根据情况增加或减少物理块</li>
</ul>
<p>置换策略</p>
<ul>
<li>局部置换:发生缺页时选择进程自己的物理块置换</li>
<li>全局置换:可以将os的空闲物理块分配给缺页进程，也可以别的进程持有的物理块置换到外存后分配给缺页进程</li>
</ul>
<p>可组合出以下三种适用的策略</p>
<ul>
<li>固定分配局部置换</li>
<li>可变分配局部置换</li>
<li>可变分配全局置换</li>
</ul>
<h5 id="页面调入"><a href="#页面调入" class="headerlink" title="页面调入"></a>页面调入</h5>
<p>何时调入页面：</p>
<ul>
<li>预调页策略：准确度不高</li>
<li>请求调页策略：发现缺页再调入，系统开销较大</li>
</ul>
<p>调入哪些页面：</p>
<ul>
<li>请求调页策略：调入发生缺页的页面</li>
<li>预调页策略：调入临近页面</li>
</ul>
<p>调页的位置：</p>
<ul>
<li>对换区：修改过的页被换出时入对换区，比较快</li>
<li>文件区：比较慢</li>
<li>UNIX方式</li>
</ul>
<h5 id="页面换出"><a href="#页面换出" class="headerlink" title="页面换出"></a>页面换出</h5>
<ul>
<li>通常为全局置换</li>
<li>调页且发现无空闲页框时，交换进程周期性检测</li>
</ul>
<h5 id="页面置换"><a href="#页面置换" class="headerlink" title="页面置换"></a>页面置换</h5>
<ul>
<li>查找所需页在磁盘上的位置</li>
<li>查找一个空闲页框，如果有空闲页框，就使用它；如果没有空闲页框，就选择一个页面并淘汰之；</li>
<li>将淘汰页面的内容写到磁盘上，改变页表</li>
<li>将所需页读入（新）空闲页框，改变页表</li>
<li>重启用户进程</li>
</ul>
<p><img src="/assets/Operate-System/image-20241107111933204.png" alt="image-20241107111933204"></p>
<h3 id="置换算法"><a href="#置换算法" class="headerlink" title="置换算法"></a>置换算法</h3>
<p>概念：选择换出页面的算法
评价标准：页面交换的频率
设计目标：优先换出不再访问的页面和最久不访问的页面
设计原则：基于过于页面访问行为预测将来的页面访问</p>
<h4 id="最优置换算法OPT"><a href="#最优置换算法OPT" class="headerlink" title="最优置换算法OPT"></a>最优置换算法OPT</h4>
<p>基本思想：换出不再访问的页面，换出下次访问距离当前时间最长的页面
评价：</p>
<ul>
<li>属于理想算法，通过<strong>未来</strong>页面走向选择被淘汰的页面，可以保证最少的缺页中断次数</li>
<li>需要知道未来访问的顺序，不可能实现，是其他算法的baseline</li>
</ul>
<p>例子
发生缺页中断次数：9
页面置换次数：6
<img src="/assets/Operate-System/image-20241107111957416.png" alt="image-20241107111957416"></p>
<h4 id="先进先出算法FIFO"><a href="#先进先出算法FIFO" class="headerlink" title="先进先出算法FIFO"></a>先进先出算法FIFO</h4>
<p>基本思想：换出最早调入内存的页面
实现：采取链表结构
评价：</p>
<ul>
<li>简单易于实现</li>
<li>未考虑程序的时间局部性原理</li>
<li>存在Belady现象：随着分配的页框数增加，缺页中断次数反而增加</li>
</ul>
<p>例子
发生缺页中断次数：14
页面置换的次数：11
<img src="/assets/Operate-System/image-20241107112012243.png" alt="image-20241107112012243"></p>
<h4 id="最近最久未使用算法LRU"><a href="#最近最久未使用算法LRU" class="headerlink" title="最近最久未使用算法LRU"></a>最近最久未使用算法LRU</h4>
<p>基本思想：时间局部性原理
算法：选择最近一段时间最长时间没有被访问过的页面淘汰
实现：寄存器表+双向链表
评价：</p>
<ul>
<li>性能较好，因为基于时间的局部性原理</li>
<li>开销过大，需要统计页面的访问时间信息，获取最久未使用页面，又是页面数过大，寄存器表不现实；</li>
</ul>
<p>例子：
发生缺页中断的次数：12
页面置换的次数：9</p>
<p><img src="/assets/Operate-System/image-20241107112101674.png" alt="image-20241107112101674"></p>
<h4 id="时钟置换算法CLOCK-Not-Recently-Used"><a href="#时钟置换算法CLOCK-Not-Recently-Used" class="headerlink" title="时钟置换算法CLOCK Not Recently Used"></a>时钟置换算法CLOCK Not Recently Used</h4>
<p>基本思想：对LRU算法的近似，换出最近未访问的页面的NRU算法；
实现：</p>
<ul>
<li>每个页面设置访问位R，访问时置1</li>
<li>页框内所有页面保存在环形链表中</li>
<li>发生缺页中断时，优先检查表指针指向页面，若R=0，淘汰页面；R=1，清除R位，前向移动指针，找到访问位为0的页面后换出；</li>
</ul>
<p>评价：</p>
<ul>
<li>算法简单</li>
<li>性能和置换间的间隔密切相关，过大过小可调整随机选择换出页面</li>
<li>未考虑页面修改情况</li>
</ul>
<p><img src="/assets/Operate-System/image-20241107111259611.png" alt="image-20241107111259611"></p>
<p>对页面修改进行改进：页面分类</p>
<ol>
<li>最近未被访问，未被修改：最佳淘汰页</li>
<li>最近未被访问，但已被修改</li>
<li>最近被访问，未被修改</li>
<li>最近被访问且被修改</li>
</ol>
<p>改进实现：</p>
<ol>
<li>选择1类页面</li>
<li>若失败，寻找第2类页面，并把扫描过的页面访问位置0</li>
<li>若步骤2失败，回到步骤1</li>
</ol>
<h3 id="缺页率"><a href="#缺页率" class="headerlink" title="缺页率"></a>缺页率</h3>
<p>发生缺页的次数/总访问次数</p>
<ul>
<li>页面置换算法</li>
<li>页面大小</li>
<li>进程所占的页框数</li>
<li>程序本身</li>
</ul>
<p>矩阵<code>int a[100][100]</code>以行优先进行存储。有一请求分页存储管理系统,物理内存共有3页,其中1页用来存放程序,其余2页用于存放数据。假设程序已在内存中占1页,其余2页空闲;数组中的元素按行编址存放。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">for (i=0; i&lt;=99; i++)</span><br><span class="line">	for (j=0; j&lt;=99; j++)</span><br><span class="line">		a[i][j]=0;</span><br><span class="line">		</span><br><span class="line">for (j=0; j&lt;=99; j++)</span><br><span class="line">	for (i=0; i&lt;=99; i++)</span><br><span class="line">		b[i][j]=0;</span><br></pre></td></tr></table></figure>
<p>假定两个内存页，每页200个数据；</p>
<p>程序A对数组的访问顺序与存储顺序一致，每访问2行数组元素就会产生一次缺页中断， 故缺页中断次数为50</p>
<p>程序B对数组的访问顺序与存储顺序不一致，每访问 数组元素就会产生一次缺页中断，故缺页中断次数为5000</p>
<p>平均访问时间：<svg style="vertical-align: -0.566ex;" xmlns="http://www.w3.org/2000/svg" width="15.93ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 7041 1000" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-13-TEX-N-28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z"></path><path id="MJX-13-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path><path id="MJX-13-TEX-N-2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z"></path><path id="MJX-13-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-13-TEX-N-29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z"></path><path id="MJX-13-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-13-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-13-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-13-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mo"><use data-c="28" xlink:href="#MJX-13-TEX-N-28"></use></g><g data-mml-node="mn" transform="translate(389,0)"><use data-c="31" xlink:href="#MJX-13-TEX-N-31"></use></g><g data-mml-node="mo" transform="translate(1111.2,0)"><use data-c="2212" xlink:href="#MJX-13-TEX-N-2212"></use></g><g data-mml-node="mi" transform="translate(2111.4,0)"><use data-c="1D45D" xlink:href="#MJX-13-TEX-I-1D45D"></use></g><g data-mml-node="mo" transform="translate(2614.4,0)"><use data-c="29" xlink:href="#MJX-13-TEX-N-29"></use></g><g data-mml-node="msub" transform="translate(3003.4,0)"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-13-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(911,-150) scale(0.707)"><use data-c="1D44E" xlink:href="#MJX-13-TEX-I-1D44E"></use></g></g><g data-mml-node="mo" transform="translate(4560.7,0)"><use data-c="2B" xlink:href="#MJX-13-TEX-N-2B"></use></g><g data-mml-node="mi" transform="translate(5560.9,0)"><use data-c="1D45D" xlink:href="#MJX-13-TEX-I-1D45D"></use></g><g data-mml-node="msub" transform="translate(6063.9,0)"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-13-TEX-I-1D451"></use></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><use data-c="1D44E" xlink:href="#MJX-13-TEX-I-1D44E"></use></g></g></g></g></svg></p>
<ul>
<li>缺页率为<svg style="vertical-align: -0.439ex;" xmlns="http://www.w3.org/2000/svg" width="1.138ex" height="1.439ex" role="img" focusable="false" viewBox="0 -442 503 636" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-14-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-14-TEX-I-1D45D"></use></g></g></g></svg></li>
<li>内存访问时间为<svg style="vertical-align: -0.355ex;" xmlns="http://www.w3.org/2000/svg" width="3.02ex" height="1.355ex" role="img" focusable="false" viewBox="0 -442 1335.1 599.1" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-15-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-15-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-15-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(911,-150) scale(0.707)"><use data-c="1D44E" xlink:href="#MJX-15-TEX-I-1D44E"></use></g></g></g></g></svg></li>
<li>发生缺页时访问时间为<svg style="vertical-align: -0.355ex;" xmlns="http://www.w3.org/2000/svg" width="2.211ex" height="1.926ex" role="img" focusable="false" viewBox="0 -694 977.1 851.1" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-16-TEX-I-1D451" d="M366 683Q367 683 438 688T511 694Q523 694 523 686Q523 679 450 384T375 83T374 68Q374 26 402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487H491Q506 153 506 145Q506 140 503 129Q490 79 473 48T445 8T417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157Q33 205 53 255T101 341Q148 398 195 420T280 442Q336 442 364 400Q369 394 369 396Q370 400 396 505T424 616Q424 629 417 632T378 637H357Q351 643 351 645T353 664Q358 683 366 683ZM352 326Q329 405 277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q233 26 290 98L298 109L352 326Z"></path><path id="MJX-16-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D451" xlink:href="#MJX-16-TEX-I-1D451"></use></g><g data-mml-node="mi" transform="translate(553,-150) scale(0.707)"><use data-c="1D44E" xlink:href="#MJX-16-TEX-I-1D44E"></use></g></g></g></g></svg></li>
</ul>
<p>有效访问时间构成：</p>
<ul>
<li>缺页服务时间</li>
<li>进程重新执行时间</li>
<li>页面调入时间（主要）：寻道时间+旋转时间+数据传送时间</li>
</ul>
<h3 id="工作集"><a href="#工作集" class="headerlink" title="工作集"></a>工作集</h3>
<p>进程对地址空间的访问不均匀，在确定的时间内，进程往往只访问固定的几个页面；
工作集：在某段时间间隔内，进程实际要访问的页面的集合</p>
<ul>
<li>进程分配的页框数不能少于工作集大小</li>
<li>不同时刻，进程的工作集大小可能不同，系统根据缺页率动态调整进程的分配页框数</li>
</ul>
<p>缺页率和物理块数关系</p>
<p><img src="/assets/Operate-System/image-20241107113845398.png" alt="image-20241107113845398"></p>
<h3 id="抖动-颠簸thrashing"><a href="#抖动-颠簸thrashing" class="headerlink" title="抖动/颠簸thrashing"></a>抖动/颠簸thrashing</h3>
<p>抖动是虚拟存储的典型问题</p>
<ul>
<li>页面被频繁地换入换出，缺页率增加</li>
<li>内存有效存取时间加长</li>
<li>系统吞吐量骤减，系统难以完成任务</li>
</ul>
<p>原因：</p>
<ul>
<li>CPU利用率低，调度程序增加并发，导致内存不足，缺页，I/O忙碌，CPU空闲</li>
<li>多道程序并发度高，每个进程分配的页框数数目少</li>
</ul>
<p><img src="/assets/Operate-System/image-20241107113904932.png" alt="image-20241107113904932"></p>
<p>抖动的预防</p>
<ul>
<li>采取局部置换策略：某进程发生缺页时，仅在自己内存空间范围内置换页面，创建新进程不会几张其他进程的内存空间</li>
<li>CPU调度程序采取工作集算法：防止调入过多的新任务，每个进程应具有超过其工作集大小的页框数</li>
<li>L=S准则：发生缺页的平均时间L等于处理缺页故障的平均时间S，此时系统具有最好的并发度</li>
<li>挂起若干进程</li>
</ul>
<h3 id="请求分页存储管理"><a href="#请求分页存储管理" class="headerlink" title="请求分页存储管理"></a>请求分页存储管理</h3>
<h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4>
<ul>
<li>存在页内碎片，但碎片相对较小，内存利用率较高</li>
<li>实现了离散分配</li>
<li>无外部碎片</li>
<li>提供了虚拟存储器，使大作业可以在较小的实际内存中运行</li>
<li>并发度高</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4>
<ul>
<li>必须有相应的硬件支持</li>
<li>不支持动态链接，不易实现共享</li>
<li>可能发生系统抖动现象</li>
</ul>
<h4 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h4>
<ul>
<li>建立在基本分段机制上:
<ul>
<li>程序的逻辑地址空间被划分为若干个大小不同的段</li>
<li>每个逻辑段装载到一段连续的物理内存区域</li>
<li>段表记录逻辑段和物理段的对应情况</li>
</ul>
</li>
<li>引入请求调度和分段置换机制
<ul>
<li>部分逻辑段载入内存</li>
<li>对换机制</li>
<li>以段作为换入或换出的基本单位</li>
</ul>
</li>
</ul>
<h4 id="段表机制"><a href="#段表机制" class="headerlink" title="段表机制"></a>段表机制</h4>
<p>段表寄存器地址组成如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;段号&gt;&lt;段长&gt;&lt;段首址&gt;&lt;存取方式&gt;&lt;访问位A&gt;&lt;修改位M&gt;&lt;状态位P&gt;&lt;增补位&gt;&lt;外存地址&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>访问字段A：用于记录本段在一段时间内被访问的次数</li>
<li>修改位M：表示该段在调入内存是否被修改</li>
<li>状态位P：用于指示本段是否调入内存</li>
<li>增补位：特殊字段，用于表示本段在运行时是否动态增长</li>
<li>外存地址：指示本段在外存中的地址；</li>
</ul>
<h4 id="缺段中断"><a href="#缺段中断" class="headerlink" title="缺段中断"></a>缺段中断</h4>
<p>每当所要访问的段不在内存时，便产生缺段中断，请求OS 将所缺之段调入内存。</p>
<p>段中断不会发生一条指令被分割在两个段的情况；</p>
<p><img src="/assets/Operate-System/image-20241107105501061.png" alt="image-20241107105501061"></p>
<h4 id="地址转换"><a href="#地址转换" class="headerlink" title="地址转换"></a>地址转换</h4>
<p>访问一个段地址<code>[s][w]</code>时，检查三种条件是否发生错误：</p>
<ul>
<li>w超过段长：报越界错误</li>
<li>存取方式位不符合：触发中断保护</li>
<li>检查段s是否在主存：缺段中断处理</li>
</ul>
<p><img src="/assets/Operate-System/image-20241107105956335.png" alt="image-20241107105956335"></p>
<h4 id="动态链接-链接中断"><a href="#动态链接-链接中断" class="headerlink" title="动态链接&amp;链接中断"></a>动态链接&amp;链接中断</h4>
<p>动态链接实现：请求分段存储管理</p>
<p>程序运行时，只讲主程序段装配好，调入内存，其他段在运行时装配完成；</p>
<p>调用新段时，将新段装配好并链接主段；</p>
<h3 id="段页式虚拟存储技术"><a href="#段页式虚拟存储技术" class="headerlink" title="段页式虚拟存储技术"></a>段页式虚拟存储技术</h3>
<ul>
<li>建立在段页式存储技术之上
<ul>
<li>程序的逻辑空间划分为若干大小不同的段</li>
<li>每个段划分为若干固定大小的页面</li>
<li>物理内存划分为若干固定大小的页框</li>
<li>页面可以载入任意页框——页表记录载入情况</li>
</ul>
</li>
<li>引入请求调页和页面置换机制
<ul>
<li>部分页面载入内存</li>
<li>对换机制</li>
<li>以页面作为换入或换出的基本单位</li>
</ul>
</li>
<li>地址变换：先查段表，再查该段的页表</li>
</ul>
<h3 id="共享和保护"><a href="#共享和保护" class="headerlink" title="共享和保护"></a>共享和保护</h3>
<p>整个系统共享一张共享段表：段本身信息，引用者信息；</p>
<p>共享段表地址组成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;段名&gt;&lt;段长&gt;&lt;内存地址&gt;&lt;状态&gt;&lt;外存起始地址&gt;&lt;共享进程计数count&gt;&lt;状态&gt;&lt;进程名&gt;&lt;段号&gt;&lt;存取控制&gt;</span><br></pre></td></tr></table></figure>
<p>共享段的分配：第一次访问需要分配内存，增加共享段表，修改进程段表，后续访问无需分配内存；</p>
<p>保护：</p>
<ul>
<li>段号越界检查</li>
<li>段内页号越界检查</li>
</ul>
<p>其中环保护中，内环可访问外环数据，外环请求内环服务；</p>
<p><img src="/assets/Operate-System/image-20241107111028443.png" alt="image-20241107111028443"></p>
</main>


<script src="/js/theme.js"></script>


<script src="/js/code-block-header.js"></script>


<script src="/js/code-block-copy.js"></script>


<script src="/js/code-block-theme-toggle.js"></script>


<script src="/js/code-block.js"></script>



<link rel="stylesheet" href="/css/article.css">

    
    <!-- giscus评论区 -->
    
  <div id="giscus_thread"></div>

  </div>
</article>
  
</main>

      <!-- 页脚 -->
      <footer class="footer">
  
  <span>Copyright © Kytolly(shiroi)</span>
  
  <div class="theme-switch-wrapper">
    <div class="theme-switch">
      <div class="theme-switch-item light-mode active">
        <img src="/icon/light.svg" class="icon">
      </div>
      <div class="theme-switch-item dark-mode">
        <img src="/icon/dark.svg" class="icon">
      </div>
    </div>
  </div>
</footer>


<link rel="stylesheet" href="/css/footer.css">


<script src="/js/theme-switcher.js"></script>


<script src="/js/giscus.js"></script>


      
  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <img src="/icon/search.svg" alt="Search Icon" class="search-icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <img src="/icon/search.svg" alt="Search Icon" style="width:5em;height:5em;">
        </div>
        <ul id="search-results"></ul>
      </div>
    </div>
  </div>

<link rel="stylesheet" href="/css/search.css">



    </div>
    
<script src="/js/background.js"></script>

  </body>

</html>