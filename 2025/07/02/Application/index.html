<!DOCTYPE html>
<html>
<meta charset="utf-8" />
  <!-- 标签页 -->
  <!-- 标签页 -->
<title>
    Application
</title>


<link rel="shortcut icon" href="/icon.svg">


  <body>  
    <!-- 配置引用 -->
    <script>
  window.THEME_CONFIG = {
    image: {
      enable: 'true',
      center: 'true',
      caption: 'true'
    },
    code_block: {
      copy_button: "icon/copy.svg",
      theme_toggle: {
        enable: 'true',
        to_light_button: "icon/light.svg",
        to_dark_button: "icon/dark.svg",
        light_theme: "/css/vscode-modern-light.css",
        dark_theme: "/css/vscode-modern-dark.css"
      },
      mac_enhancer: {
        enable: 'true',
        init_folded_status: 'true'
      }
    },
    giscus: {
      repo: "Kytolly/MyGiscus",
      repo_id: "R_kgDOK_0_0A",
      category: "Announcements",
      category_id: "DIC_kwDOK_0_0A",
      mapping: "pathname",
      strict: "0",
      reactions_enabled: "1",
      emit_metadata: "0",
      input_position: "top",
      lang: "zh-CN",
      loading: "lazy"
    },
    heading_numbering: 'true',
    three_line_table: 'true',
    background: {
      enable: 'true',
      folder: 'img/',
      opacity: '0.1',
      position: 'center',
      size: 'cover',
      repeat: 'no-repeat',
      image: {
        mode: 'random',
        name: 'background.jpg',
        count: '113'
      }
    },
  };
</script>
<script>
  console.log(window.THEME_CONFIG);
</script>

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    
    <!-- 字体 -->
    <!-- 字体 -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <!-- 代码块 -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
      
        <link rel="stylesheet" href="/css/vscode-modern-light.css">
        <link rel="stylesheet" href="/css/vscode-modern-dark.css">
        <!-- DEBUG: url_for light path: /css/vscode-modern-light.css -->
        <!-- DEBUG: url_for dark path: /css/vscode-modern-dark.css -->
      
    
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>

    <!-- 数学公式 -->
    
<link rel="stylesheet" href="/css/mathjax.css">

    
<script src="/js/mathjax.js"></script>

    
    <!-- 标题编号 -->
    
      
<link rel="stylesheet" href="/css/heading-numbering.css">

      
<script src="/js/heading-numbering.js"></script>

    
    
    <!-- 三线表样式 -->
    
      
<link rel="stylesheet" href="/css/three-line-table.css">

    
  
    <!-- 图片样式 -->
    
      
<link rel="stylesheet" href="/css/image-handler.css">

      
<script src="/js/image-handler.js"></script>

    
    
  
    
<link rel="stylesheet" href="/css/root.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/post.css">


    <!-- 代码块基础样式 -->
    
<link rel="stylesheet" href="/css/code-block-base.css">

  
    <!-- Codeblock Theme Toggler CSS -->
    
    
<link rel="stylesheet" href="/css/codeblock-theme-toggle.css">

    
  
    <!-- Codeblock Mac Enhancer CSS -->
    
    
<link rel="stylesheet" href="/css/code-block-mac-enhancer.css">

    
  
    <!-- TOC 样式 -->
    <link rel="stylesheet" href="/css/toc.css">
    
  <!-- hexo injector head_end start -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
  <!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0">
</head>


    <div class="site-container">
      <!-- 导航栏 -->
      <!--(头部 top bar) Header 样式 -->

<link rel="stylesheet" href="/css/header.css">


<header class="header">
  <section class="header-container">
    <a class="header-logo" href="/">Kytolly&#39;s Blog</a>
    <div class="header-right-section">
      <ul class="header-nav">
        
        <li>
          <a href="/">
            <img src="/icon/index.svg" alt="index icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            index
          </a>
        </li>
        
        <li>
          <a href="/archive">
            <img src="/icon/archive.svg" alt="archive icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            archive
          </a>
        </li>
        
        <li>
          <a href="/tag">
            <img src="/icon/tag.svg" alt="tag icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            tag
          </a>
        </li>
        
        <li>
          <a href="/about">
            <img src="/icon/about.svg" alt="about icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            about
          </a>
        </li>
        
      </ul>
      
      
      <div class="header-search-container search-trigger">
        <img src="/icon/search.svg" alt="Search Icon" class="search-icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
        <input type="text" id="header-search-input" placeholder="searching..." readonly>
      </div>
      
    </div>
  </section>
</header>


<script src="/js/search.js"></script>


      <!-- 路由 根据页面类型决定渲染内容 -->
      <main class="main">
  
    <article class="post-container">
  <!-- 可选：左侧跟随目录 -->
  
  <aside id="toc-container" class="toc-container toc-left toc-expanded">
    <div id="toc-title" class="toc-title">Application</div>
    <div id="toc-content" class="toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E5%BA%94%E7%94%A8"><span class="toc-number">1.</span> <span class="toc-text">网络应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E8%AE%AE%E7%89%B9%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">协议特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%94%E5%8F%91"><span class="toc-number">1.2.</span> <span class="toc-text">研发</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.</span> <span class="toc-text">体系结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1"><span class="toc-number">1.4.</span> <span class="toc-text">进程通信</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="toc-number">1.5.</span> <span class="toc-text">套接字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%AF%BB%E5%9D%80"><span class="toc-number">1.6.</span> <span class="toc-text">进程寻址</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%B1%82%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.7.</span> <span class="toc-text">应用层协议</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%A0%E8%BE%93%E5%B1%82%E7%9A%84%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.8.</span> <span class="toc-text">传输层的服务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E5%8D%8F%E8%AE%AE"><span class="toc-number">2.</span> <span class="toc-text">HTTP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Web"><span class="toc-number">2.1.</span> <span class="toc-text">Web</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F"><span class="toc-number">2.2.</span> <span class="toc-text">报文格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">2.3.</span> <span class="toc-text">工作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cookie"><span class="toc-number">2.4.</span> <span class="toc-text">Cookie</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web%E7%BC%93%E5%AD%98"><span class="toc-number">2.5.</span> <span class="toc-text">Web缓存</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FTP"><span class="toc-number">3.</span> <span class="toc-text">FTP</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-number">3.1.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1"><span class="toc-number">3.2.</span> <span class="toc-text">设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4-%E5%BA%94%E7%AD%94"><span class="toc-number">3.3.</span> <span class="toc-text">命令 &amp; 应答</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Email"><span class="toc-number">4.</span> <span class="toc-text">Email</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1-1"><span class="toc-number">4.1.</span> <span class="toc-text">设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SMTP"><span class="toc-number">4.2.</span> <span class="toc-text">SMTP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8C%87%E4%BB%A4-%E5%BA%94%E7%AD%94"><span class="toc-number">4.3.</span> <span class="toc-text">指令 &amp; 应答</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%AE%E4%BB%B6%E6%B6%88%E6%81%AF%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">4.4.</span> <span class="toc-text">邮件消息的格式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%82%AE%E4%BB%B6%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE"><span class="toc-number">4.5.</span> <span class="toc-text">邮件访问协议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DNS"><span class="toc-number">5.</span> <span class="toc-text">DNS</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1"><span class="toc-number">5.1.</span> <span class="toc-text">服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E6%A0%91%E5%91%BD%E5%90%8D"><span class="toc-number">5.2.</span> <span class="toc-text">层次树命名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%93%E5%AD%98"><span class="toc-number">5.3.</span> <span class="toc-text">缓存</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95"><span class="toc-number">5.4.</span> <span class="toc-text">记录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B6%88%E6%81%AF"><span class="toc-number">5.5.</span> <span class="toc-text">消息</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#P2P"><span class="toc-number">6.</span> <span class="toc-text">P2P</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E8%AE%A1-2"><span class="toc-number">6.1.</span> <span class="toc-text">设计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E6%97%B6%E9%97%B4"><span class="toc-number">6.2.</span> <span class="toc-text">内容分发时间</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#P2P%E7%BD%91%E7%BB%9C%E4%BC%98%E7%BC%BA%E7%82%B9"><span class="toc-number">6.3.</span> <span class="toc-text">P2P网络优缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E4%B8%AD%E5%BC%8F%E5%92%8C%E9%9D%9E%E9%9B%86%E4%B8%AD%E5%BC%8F%E6%90%9C%E7%B4%A2"><span class="toc-number">6.4.</span> <span class="toc-text">集中式和非集中式搜索</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E5%BC%8F%E6%9E%B6%E6%9E%84%EF%BC%9AKaZaA"><span class="toc-number">6.5.</span> <span class="toc-text">混合式架构：KaZaA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CDN"><span class="toc-number">7.</span> <span class="toc-text">CDN</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP-stream-DASH"><span class="toc-number">7.1.</span> <span class="toc-text">HTTP stream &amp; DASH</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CDN-1"><span class="toc-number">7.2.</span> <span class="toc-text">CDN</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%97%E6%8E%A5%E5%AD%97%E7%BC%96%E7%A8%8B"><span class="toc-number">8.</span> <span class="toc-text">套接字编程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Stream"><span class="toc-number">8.1.</span> <span class="toc-text">Stream</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Datagram"><span class="toc-number">8.2.</span> <span class="toc-text">Datagram</span></a></li></ol></li></ol>
    </div>
  </aside>
 


<script src="/js/toc.js"></script>


  <!-- 可选：右侧 AI 摘要 -->
  

  <div class="post-main-wrapper">
    <!-- 文章 -->
    <div class="post-title">Application</div>
  <div class="post-meta">
    <div class="date">2025 七月 2日</div>
    <div class="tags">
      
        
        <div class="tag-item">Computer-Network</div>
        
        <div class="tag-item">Coursework</div>
        
      
    </div>
  </div>

<main class="post-content"><h2 id="网络应用"><a href="#网络应用" class="headerlink" title="网络应用"></a>网络应用</h2>
<h3 id="协议特点"><a href="#协议特点" class="headerlink" title="协议特点"></a>协议特点</h3>
<p>每个应用层协议都是为了解决某一类应用问题，而问题的解决又往往是通过位于不同主机中的多个应用进程之间的通信和协同工作来完成的。应用层的具体内容就是规定应用进程在通信时所遵循的协议。
应用层的许多协议都是基于客户服务器方式。</p>
<p>客户(client)和服务器(server)都是指通信中所涉及的两个应用进程。客户服务器方式所描述的是进程之间服务和被服务的关系。客户是服务请求方，服务器是服务提供方。</p>
<h3 id="研发"><a href="#研发" class="headerlink" title="研发"></a>研发</h3>
<p>网络应用是计算机网络存在的理由，它存在于不同的端系统上，而不是网络核心设备上，这种设计促进了应用程序的研发；</p>
<p>常见的应用有电子邮件，Web，即时讯息，远程登陆，P2P文件共享，多用户网络游戏，流式存储视频片段，因特网电话，实时视频会议；</p>
<h3 id="体系结构"><a href="#体系结构" class="headerlink" title="体系结构"></a>体系结构</h3>
<p><strong>应用体系结构</strong>(application architecture)由应用程序研发者设计，常见的包括</p>
<ul>
<li><strong>客户端-服务器体系架构</strong>(client-server architecture)：总是存在一个打开的服务器主机，接受来自客户主机的请求，具有固定的、众所周知的地址，主机群集常被用于创建强大的虚拟服务器；客户之间不能相互通信，同服务端通信，间断和服务器进行连接，拥有动态的地址；</li>
<li><strong>P2P体系结构</strong>(P2P architecture)：对数据中心专用服务器几乎没有依赖，应用程序在对等主机间通信；通常不需要庞大的服务器群和带宽；对等放间歇连接并改变地址，具有自拓展性和高度非集中式结构；但可能难以管理；</li>
</ul>
<p>有时也会有将两种体系结构混合使用的应用，比如Napster，即时讯息；</p>
<h3 id="进程通信"><a href="#进程通信" class="headerlink" title="进程通信"></a>进程通信</h3>
<p>从操作系统的角度来看，通信的实体是进程；同一主机上的两个进程通过内部进程通信机制进行通信；不同主机上的进程通过跨越计算机网络交换报文而相互通信；</p>
<ul>
<li>成对的进程中，发起通信方表示为客户，会话开始时等待联系方标识为服务器；</li>
<li>进程通过套接字接口向网络发送和接受报文；</li>
<li>进程寻址需要定义1. 主机地址 2. 目的主机指定接受进程的标识符；</li>
</ul>
<h3 id="套接字"><a href="#套接字" class="headerlink" title="套接字"></a>套接字</h3>
<p><strong>套接字</strong>(socket)是应用程序进程和运输层协议之间的接口，也称应用程序编程接口API ；</p>
<ul>
<li>发送端的应用将报文推给套接字；</li>
<li>运输层负责将从套接字获得报文；</li>
</ul>
<blockquote>
<p>可以用门户类比套接字；</p>
</blockquote>
<p>用户通过API对传输层的控制仅限于选择传输协议或设定一些参数；</p>
<h3 id="进程寻址"><a href="#进程寻址" class="headerlink" title="进程寻址"></a>进程寻址</h3>
<p>为了一个进程能接收报文，它需要一个标识</p>
<ul>
<li>主机有唯一的32位IP地址</li>
<li>主机上的进程标识包括IP地址和端口号</li>
</ul>
<p>比如Web服务经常运行在80端口，而SSH服务运行在22端口上；</p>
<h3 id="应用层协议"><a href="#应用层协议" class="headerlink" title="应用层协议"></a>应用层协议</h3>
<p>回忆协议的基本要素：交换的报文类型，报文类型的语法，字段的语义，进程何时、如何发送报文及对报文进行响应；</p>
<p>由RFC定义一些公共领域协议供大家使用，比如HTTP，SMTP；也有一些专用协议KaZaA；</p>
<h3 id="传输层的服务"><a href="#传输层的服务" class="headerlink" title="传输层的服务"></a>传输层的服务</h3>
<p>回忆协议栈知识，下层协议向上层提供服务，</p>
<p>运输层协议的选择的依据是应用程序服务要求，常见如下：</p>
<ol>
<li>可靠数据传输：应用要求数据的可靠性，但是网络传输是不可靠的；选择提供可靠数据传输服务的协议时，进程将数据传给套接字后，就可以相信数据能无差错到达接收进程；但是有些应用是容忍丢失的，比如多媒体应用；</li>
<li>吞吐量：通常是一些<strong>带宽敏感</strong>(bandwidth-sensitive)的应用，比如多媒体；而<strong>弹性</strong>(elastic)应用能够自主决定使用的吞吐量；</li>
<li>定时：比如电话等，需要提供定时保证的运输层协议；</li>
<li>安全性：有些应用要求数据必须加密传输；</li>
</ol>
<p>更直接地说，开发Internet应用程序，需要选择的两个运输层协议是：TCP和UDP；</p>
<p>它们的共同点是：都<strong>没有提供时延保证和最小带宽保证</strong>；没有提供任何加密机制；</p>
<p>它们的区别可以用下表概括：</p>
<table>
<thead>
<tr>
<th style="text-align:left">特性</th>
<th style="text-align:left">TCP (Transmission Control Protocol)</th>
<th style="text-align:left">UDP (User Datagram Protocol)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>连接类型</strong></td>
<td style="text-align:left"><strong>面向连接</strong>：在数据传输前需要建立连接（三次握手），结束后终止连接。</td>
<td style="text-align:left"><strong>无连接</strong>：直接发送数据，不建立或维护连接。</td>
</tr>
<tr>
<td style="text-align:left"><strong>可靠性</strong></td>
<td style="text-align:left"><strong>可靠</strong>：保证数据按序、无差错地到达，提供错误检查、重传和确认机制。</td>
<td style="text-align:left"><strong>不可靠</strong>：不保证数据到达、顺序或无差错，不提供错误检查或重传。</td>
</tr>
<tr>
<td style="text-align:left"><strong>速度与效率</strong></td>
<td style="text-align:left"><strong>较慢</strong>：由于连接管理、流量控制和拥塞控制，开销较大，传输速度相对慢。</td>
<td style="text-align:left"><strong>较快</strong>：开销小，传输速度快，适合对实时性要求高的应用。</td>
</tr>
<tr>
<td style="text-align:left"><strong>流量控制</strong></td>
<td style="text-align:left"><strong>有</strong>：通过滑动窗口等机制防止发送方淹没接收方。</td>
<td style="text-align:left"><strong>无</strong>：不控制发送速率，可能导致接收方过载或数据丢失。</td>
</tr>
<tr>
<td style="text-align:left"><strong>拥塞控制</strong></td>
<td style="text-align:left"><strong>有</strong>：通过算法避免网络拥塞，并在拥塞发生时减缓发送速率。</td>
<td style="text-align:left"><strong>无</strong>：不检测或避免网络拥塞，可能加剧拥塞。</td>
</tr>
<tr>
<td style="text-align:left"><strong>有序传输</strong></td>
<td style="text-align:left"><strong>有</strong>：通过序号确保数据包按序到达。</td>
<td style="text-align:left"><strong>无</strong>：数据包可能乱序到达，由应用层处理排序。</td>
</tr>
<tr>
<td style="text-align:left"><strong>头部长度</strong></td>
<td style="text-align:left"><strong>可变</strong>：20-60字节。</td>
<td style="text-align:left"><strong>固定</strong>：8字节。</td>
</tr>
<tr>
<td style="text-align:left"><strong>广播/多播</strong></td>
<td style="text-align:left"><strong>不支持</strong>：点对点通信。</td>
<td style="text-align:left"><strong>支持</strong>：适用于一对多通信。</td>
</tr>
<tr>
<td style="text-align:left"><strong>典型应用</strong></td>
<td style="text-align:left">Web浏览 (HTTP/HTTPS), 文件传输 (FTP), 电子邮件 (SMTP/POP3/IMAP), SSH</td>
<td style="text-align:left">在线游戏, 视频/音频流 (实时), VoIP (网络电话), DNS 查询, 网络监控</td>
</tr>
</tbody>
</table>
<h2 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h2>
<p>Web层应用层协议为<strong>超文本传输协议</strong>(hypertext transfer protocol, HTTP)，是Web应用的核心；遵循C/S架构，浏览器browser请求, 接收, 解释显示 Web对象，Web服务器响应请求,发送 Web对象；</p>
<h3 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h3>
<p>万维网www是一个大规模的、联机式的信息储藏所，用<strong>链接</strong>(link)的方法能非常方便地从因特网上的一个站点访问另一个站点；</p>
<ul>
<li>提供分布式服务；</li>
<li>万维网以客户服务器方式工作。</li>
<li>浏览器就是在用户计算机上的万维网客户程序。万维网文档所驻留的计算机则运行服务器程序(Apache, IIS)，因此这个计算机也称为万维网服务器。</li>
<li>客户程序向服务器程序发出请求，服务器程序向客户程序送回客户所要的万维网文档。</li>
<li>在一个客户程序主窗口上显示出的万维网文档称为页面(page)。</li>
</ul>
<p><strong>统一资源定位符</strong>  (Uniform Resource Locator，URL)来标志万维网上的各种文档；是对可以从因特网上得到的资源的位置和访问方法的一种简洁的表示。URL 给资源的位置提供一种抽象的识别方法，并用这种方法给资源定位。只要能够对资源定位，系统就可以对资源进行各种操作，如存取、更新、替换和查找其属性。
URL 相当于一个文件名在网络范围的扩展，可以理解是与因特网相连的机器上的任何可访问对象的一个指针，一般格式如下：</p>
<ul>
<li>访问方式：ftp ，http，News 等数据访问的协议</li>
<li>主机：存放资源的主机在因特网中的域名</li>
<li>端口：有时可省略，比如HTTP 的默认端口号是 80；</li>
<li>路径：有时可省略，URL 就指到因特网上的某个主页(home page)；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;URL的访问方式&gt;://&lt;主机&gt;:&lt;端口&gt;/&lt;路径&gt;  </span><br></pre></td></tr></table></figure>
<p><strong>超文本标记语言</strong>  (HyperText Markup Language)使得万维网页面的设计者可以很方便地用一个超链从本页面的某处链接到因特网上的任何一个万维网页面，并且能够在自己的计算机屏幕上将这些页面显示出来。</p>
<p>一个Web文档(Web page)是由Web对象组成的;</p>
<ul>
<li>Web对象对应一个实际的文件，比如HTML文件，JEPG图片，Javascript文件，Css样式表文件；</li>
<li>一个页面有一个HTML基本文件和若干引用对象；</li>
</ul>
<p>一个Web浏览器(Web browser)是一个实现了HTTP的客户端；因此我们常把浏览器和客户等同；</p>
<p>一个Web服务器(Web server)是一个HTTP的服务器端；</p>
<ul>
<li>用于存储Web对象；</li>
<li>对象通过一个URL寻址；</li>
</ul>
<h3 id="报文格式"><a href="#报文格式" class="headerlink" title="报文格式"></a>报文格式</h3>
<p>HTTP报文是客户端和服务器之间交换数据的机制，主要分为两种类型：<strong>请求报文</strong>（由客户端发送）和<strong>响应报文</strong>（由服务器发送）。</p>
<p>所有HTTP/1.x报文都具有相似的通用结构，包括：</p>
<ol>
<li>**起始行 **(start line)：一行文本，包含报文类型的基本信息，分为请求行和响应行；</li>
<li><strong>头部字段</strong> (header line)：零行或多行键值对，提供关于报文的元数据，例如主机、内容类型、长度等。</li>
<li><strong>空行</strong>：一个回车符和换行符，表示头部字段的结束。</li>
<li><strong>报文主体</strong>：可选部分，包含实际传输的数据（如HTML文件、图片、表单数据等）。</li>
</ol>
<p><strong>TTP请求报文格式</strong>用于客户端向服务器请求某个资源或提交数据，其格式如下：</p>
<ul>
<li>方法：指示对资源执行的动作，如 <code>GET</code>（获取资源）、<code>POST</code>（提交数据）、<code>HEAD</code>（获取资源头部）、<code>PUT</code>（更新资源）、<code>DELETE</code>（删除资源）等。</li>
<li>请求URI：标识所请求资源的统一资源标识符（URL的路径部分）。</li>
<li>HTTP版本：表示请求使用的HTTP协议版本，通常是 <code>HTTP/1.1</code>。</li>
<li>头部字段：提供请求的附加信息，例如：
<ol>
<li><code>Host</code>: 目的主机和端口号。</li>
<li><code>User-Agent</code>: 发送请求的用户代理（浏览器）信息。</li>
<li><code>Accept</code>: 客户端能够处理的媒体类型。</li>
<li><code>Content-Type</code>: 报文主体的媒体类型（如果存在报文主体）。</li>
<li><code>Content-Length</code>: 报文主体的长度（如果存在报文主体）。</li>
</ol>
</li>
<li><strong>报文主体 (Message Body)</strong>：包含客户端发送给服务器的数据，主要用于 <code>POST</code> 和 <code>PUT</code> 请求。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;方法&gt; &lt;请求URI&gt; &lt;HTTP版本&gt;</span><br><span class="line">&lt;头部字段1&gt;: &lt;值&gt;</span><br><span class="line">&lt;头部字段2&gt;: &lt;值&gt;</span><br><span class="line">...</span><br><span class="line">&lt;空行&gt;</span><br><span class="line">[报文主体]</span><br></pre></td></tr></table></figure>
<p><img src="/assets/Computer-Network/HTTP%E8%AF%B7%E6%B1%82%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F.png" alt=""></p>
<p><strong>HTTP响应报文</strong>用于服务器对客户端请求的回复，其格式如下：</p>
<ul>
<li>HTTP版本：表示响应使用的HTTP协议版本。</li>
<li><strong>状态码</strong>(status code)：一个三位数字代码，指示请求的处理结果，如 <code>200</code> (OK), <code>301</code>(Move Permanently), <code>400</code>(Bad Request),<code>404</code> (Not Found), <code>500</code> (Internal Server Error) , <code>505</code>(HTTP Version Not Support)等。</li>
<li>原因短语：状态码的简短文字描述，帮助人类理解。</li>
<li>头部字段：提供响应的附加信息，例如：
<ol>
<li><code>Server</code>: 服务器软件信息。</li>
<li><code>Date</code>: 响应生成的时间。</li>
<li><code>Content-Type</code>: 响应报文主体的媒体类型。</li>
<li><code>Content-Length</code>: 响应报文主体的长度。</li>
<li><code>Last-Modified</code>: 资源的最后修改时间。</li>
</ol>
</li>
<li>报文主体：包含服务器返回给客户端的实际数据，如HTML页面内容、图片等。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;HTTP版本&gt; &lt;状态码&gt; &lt;原因短语&gt;</span><br><span class="line">&lt;头部字段1&gt;: &lt;值&gt;</span><br><span class="line">&lt;头部字段2&gt;: &lt;值&gt;</span><br><span class="line">...</span><br><span class="line">&lt;空行&gt;</span><br><span class="line">[报文主体]</span><br></pre></td></tr></table></figure>
<p><img src="/assets/Computer-Network/HTTP%E5%93%8D%E5%BA%94%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F.png" alt=""></p>
<h3 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h3>
<p>HTTP使用TCP作为运输层协议</p>
<ul>
<li>客户初始化一个与HTTP服务器80端口的TCP连接 (创建套接字)</li>
<li>HTTP服务器接受来自客户的TCP连接请求, 建立连接</li>
<li>Browser (HTTP client)和Web服务器 (HTTP server) 交换HTTP报文(应用层协议消息)包括HTTP请求和响应消息</li>
<li>最后结束(或叫关闭)TCP连接</li>
</ul>
<p><img src="/assets/Computer-Network/HTTP%E5%8D%8F%E8%AE%AE%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B.png" alt=""></p>
<p>HTTP连接以下分类，对应不同的响应时间模型</p>
<ul>
<li>持久HTTP连接：在一个TCP连接上传送多个对象，所有的请求-响应经过相同的TCP连接发送；</li>
<li>非持久HTTP连接：在一个TCP连接上只传送一个对象，每个请求-响应对通过一个单独的TCP连接上发送；</li>
</ul>
<p>定义往返时间RTT为一个小分组从客户主机到服务器，再到客户主机花费的时间，则以下动作都需要花费一个RTT</p>
<ul>
<li>建立TCP连接；</li>
<li>一对请求-响应消息的交互；</li>
</ul>
<p>HTML文件传输时间单独算作传输时延；</p>
<p><img src="/assets/Computer-Network/%E8%AF%B7%E6%B1%82%E5%B9%B6%E6%8E%A5%E6%94%B6%E4%B8%80%E4%B8%AAHTML%E6%96%87%E4%BB%B6%E9%9C%80%E8%A6%81%E7%9A%84%E6%97%B6%E9%97%B4%E4%BC%B0%E7%AE%97.png" alt=""></p>
<p>HTTP/1.0采用非持久HTTP连接，每个对象需要两个RTT，且每个TCP连接都需要由OS分配主机资源，不利于大量客户的并发；</p>
<p>HTTP/1.1采用带流水线的持久HTTP连接中，服务器发送响应消息后保持连接，后续消息也在该连接上传送，用户遇到一个所有引用对象就发送请求，所有引用对象经历1个RTT；</p>
<p>而一类不带流水线的HTTP连接，客户必须先收到先前请求的响应消息后才能发出新的请求，每个引用对象经历一个RTT；</p>
<h3 id="Cookie"><a href="#Cookie" class="headerlink" title="Cookie"></a>Cookie</h3>
<p>虽然说HTTP是一种<strong>无状态</strong>(stateless)协议，服务器不维护客户先前的状态信息；</p>
<ul>
<li>维护状态的协议比较复杂，关键在于一致性如何保证；</li>
<li>但是一般部分网站会搭配Cookie技术一起使用，来达成维护状态的目的，以跟踪用户数据，达成会话管理，个性化推荐，跟踪分析用户行为的目的；</li>
</ul>
<p>Cookie是服务器发送到用户Web浏览器的一小段数据。</p>
<ul>
<li>浏览器可以存储Cookie，创建新的Cookie，修改现有的Cookie，并在后续请求中将其发送回同一服务器。</li>
<li>Cookie使Web应用程序能够存储有限的数据并记住状态信息；</li>
</ul>
<p>Cookie技术组件包括</p>
<ol>
<li>响应报文中的一个cookie首部行；</li>
<li>请求报文中的一个cookie首部行；</li>
<li>浏览器保存的cookie文件；</li>
<li>Web站点后端的数据库；</li>
</ol>
<p><img src="/assets/Computer-Network/cookie%E8%B7%9F%E8%B8%AA%E7%94%A8%E6%88%B7.png" alt=""></p>
<p>Cookie的工作流程如下：</p>
<ol>
<li>
<p><strong>服务器设置Cookie</strong>：当服务器收到HTTP请求并希望在客户端存储一些信息时，它会在HTTP响应头中包含一个或多个<code>Set-Cookie</code>字段。例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">Content-Type: text/html</span><br><span class="line">Set-Cookie: session_id=abc123; Expires=Wed, 31 Dec 2025 23:59:59 GMT; Path=/</span><br><span class="line">Set-Cookie: user_preference=dark_mode</span><br><span class="line"></span><br><span class="line">[页面内容]</span><br></pre></td></tr></table></figure>
<p>这个例子中，服务器设置了两个Cookie：<code>session_id</code>和<code>user_preference</code>。</p>
</li>
<li>
<p><strong>浏览器存储Cookie</strong>：浏览器收到<code>Set-Cookie</code>头后，会根据其中的指令将Cookie存储起来。</p>
</li>
<li>
<p><strong>浏览器发送Cookie</strong>：当浏览器向同一域发送后续HTTP请求时，会自动在请求头中包含之前存储的、与当前请求域和路径匹配的Cookie。服务器收到这些Cookie后，就可以识别用户并提供个性化服务。</p>
</li>
</ol>
<h3 id="Web缓存"><a href="#Web缓存" class="headerlink" title="Web缓存"></a>Web缓存</h3>
<p><strong>Web缓存</strong>(Web cache)，更常见的名字为<strong>代理服务器</strong>(proxy server)，代表初始Web服务器满足HTTP请求的网络实体；</p>
<ul>
<li>一般认为Web缓存既是服务器也是客户机；</li>
<li>设计的目的是减少对客户机请求的响应时间，减少内部网络与接入链路上的通信量，以减少Internet上的Web流量；</li>
</ul>
<p><strong>内容分发网络</strong>(content distribution network, CDN) 是通过网关缓存/反向代理，它们在全球部署缓存节点，以实现快速内容分发。通常由网站开发者部署，以提高网站的可伸缩性、可靠性和性能。</p>
<p>条件GET方法用于证实缓存器中的对象是否为最新，避免获取缓存下来的陈旧的对象副本；
缓存器：在请求报文中包含对象最后修改时间 <code>If-modified-since: &lt;date&gt;</code>
服务器: 如果对象是最新的则响应报文中不包含对象<code>HTTP/1.0 304 Not Modified</code>;</p>
<h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2>
<h3 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h3>
<p>FTP协议的主要工作是将文件从一台主机中复制到远程主机中；其中需要关注不同系统文件系统的差异性，减少不同操作系统处理文件的不兼容性；</p>
<p>FTP协议提供文件传送的基本服务：</p>
<ul>
<li>主要依靠TCP的可靠运输服务；</li>
<li>采取<strong>C/S架构</strong>，一个FTP服务器可为多个多个客户进程提供服务；</li>
<li>服务器包含一个主进程（用于处理新请求）和若干从属进程（用于处理单个请求）；</li>
</ul>
<h3 id="设计"><a href="#设计" class="headerlink" title="设计"></a>设计</h3>
<p>FTP的工作流程如下</p>
<ol>
<li>主进程运行在端口21上，等待客户进程的连接请求；</li>
<li>启动从属进程来处理客户进程发来的请求。</li>
<li>从属进程对客户进程的请求处理完毕后即终止，但从属进程在运行期间根据需要还可能创建其他一些子进程。</li>
<li>回到等待状态，继续接受其他客户进程发来的请求。主进程与从属进程的处理是并发地进行。</li>
</ol>
<p>值得注意的是，FTP协议采取两个TCP连接</p>
<ul>
<li>控制连接在整个会话期间一直保持打开，但是控制连接不用来传送文件；</li>
<li>服务器端的控制进程在接收到 FTP 客户发送来的文件传输请求后就创建"数据传送进程"和"数据连接"；
<ol>
<li>数据传送进程用来连接客户端和服务器端；</li>
<li>数据连接用于传输文件；</li>
<li>数据传送进程实际完成文件的传送，在传送完毕后关闭数据传送连接并结束运行；</li>
</ol>
</li>
<li>两个连接运行在不同的端口号上，控制连接和数据连接不会混乱
<ol>
<li>当客户进程向服务器进程发出建立连接请求时，要寻找连接服务器进程的熟知端口(21)，同时还要告诉服务器进程自己的另一个端口号码，用于建立数据传送连接。</li>
<li>接着，服务器进程用自己传送数据的熟知端口(20)与客户进程所提供的端口号码建立数据传送连接。</li>
</ol>
</li>
</ul>
<p><img src="/assets/Computer-Network/FTP%E5%8D%8F%E8%AE%AE%E9%87%87%E5%8F%96%E4%B8%A4%E4%B8%AATCP%E8%BF%9E%E6%8E%A5.png" alt=""></p>
<p>这样的设计可能有如下考虑：</p>
<ul>
<li>协议更简单，易于实现；</li>
<li>传输文件可以操作控制连接，比如发送请求终止传输；</li>
</ul>
<h3 id="命令-应答"><a href="#命令-应答" class="headerlink" title="命令 &amp; 应答"></a>命令 &amp; 应答</h3>
<p>所有命令在控制连接上以ASCII文本形式发送</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USER &lt;username&gt;</code></td>
<td>指定用户名</td>
</tr>
<tr>
<td><code>PASS &lt;password&gt;</code></td>
<td>指定密码</td>
</tr>
<tr>
<td><code>LIST</code></td>
<td>返回当前远程目录的文件列表</td>
</tr>
<tr>
<td><code>RETR &lt;filename&gt;</code></td>
<td>获取远程主机当前目录下的1个文件(get)</td>
</tr>
<tr>
<td><code>STOR &lt;filename&gt;</code></td>
<td>存放1个文件到远程主机当前目录下(put)</td>
</tr>
</tbody>
</table>
<p>下表是常见的状态码对应的短语</p>
<table>
<thead>
<tr>
<th>状态码</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>331</td>
<td>Username OK, password required</td>
</tr>
<tr>
<td>125</td>
<td>data connection already open; transfer starting</td>
</tr>
<tr>
<td>425</td>
<td>Can't open data connection</td>
</tr>
<tr>
<td>452</td>
<td>Error writing file</td>
</tr>
</tbody>
</table>
<p>以下是一个FTP控制台信息的举例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[01] ftp nic.ddn.mil </span><br><span class="line">[02] connected to nic.ddn.mil</span><br><span class="line">[03] 220 nic FTP server (Sunos 4.1)ready.</span><br><span class="line">[04] Name: anonymous</span><br><span class="line">[05] 331 Guest login ok, send ident as password.</span><br><span class="line">[06] Password: abc@xyz.math.yale.edu</span><br><span class="line">[07] 230 Guest login ok, access restrictions apply.</span><br><span class="line">[08] ftp&gt; cd rfc</span><br><span class="line">[09] 250 CWD command successful.</span><br><span class="line">[10] ftp&gt; get rfc1261.txt nicinfo</span><br><span class="line">[11] 200 PORT command successful.</span><br><span class="line">[12] 150 ASCII data connection for rfc1261.txt</span><br><span class="line">     (128.36.12.27,1401) (4318 bytes).</span><br><span class="line">[13] 226 ASCII Transfer complete.</span><br><span class="line">     local: nicinfo remote: rfc1261.txt</span><br><span class="line">     4488 bytes received in 15 seconds (0.3 Kbytes/s).</span><br><span class="line">[14] ftp&gt; quit</span><br><span class="line">[15] 221 Goodbye.</span><br></pre></td></tr></table></figure>
<p>这些信息的注释如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[01] 用户要用 FTP 和远地主机(网络信息中心NIC 上的主机)建立连接。 </span><br><span class="line">[02] 本地 FTP 发出的连接成功信息。 </span><br><span class="line">[03] 从远地服务器返回的信息，220 表示&quot;服务就绪&quot;。 </span><br><span class="line">[04] 本地 FTP 提示用户键入名字。用户键入的名字</span><br><span class="line">表示&quot;匿名&quot;。用户只需键入 anonymous 即可。 </span><br><span class="line">[05] 数字 331 表示&quot;用户名正确&quot;，需要口令。 </span><br><span class="line">[06] 本地 FTP 提示用户键入口令。用户这时可键入</span><br><span class="line">guest 作为匿名的口令，也可以键入自己的电子邮件</span><br><span class="line">地址，即耶鲁大学数学系名为 xyz 的主机上的 abc。 </span><br><span class="line">[07] 数字 230 表示用户已经注册完毕。 </span><br><span class="line">[08] &quot;&quot;ftp&gt;&quot;是 FTP 的提示信息。用户键入的是将</span><br><span class="line">目录改变为包含 RFC 文件的目录。 </span><br><span class="line">[09] 字符 CWD 是 FTP 的标准命令，</span><br><span class="line">代表 Change Working Directory。 </span><br><span class="line">[10] 用户要求将名为 rfc1261.txt 的文件复制到</span><br><span class="line">本地主机上，并改名为 nicinfo。 </span><br><span class="line">[11] 字符 PORT 是 FTP 的标准命令，表示要</span><br><span class="line">建立数据连接。200 表示&quot;命令正确&quot;。 </span><br><span class="line">[12] 数字 150 表示&quot;文件状态正确，即将建立数据连接&quot;。 </span><br><span class="line">[13] 数字 226 是&quot;释放数据连接&quot;。现在一个新的本地文件已产生。 </span><br><span class="line">[14] 用户键入退出命令。 </span><br><span class="line">[15] 表明 FTP 工作结束。 </span><br></pre></td></tr></table></figure>
<h2 id="Email"><a href="#Email" class="headerlink" title="Email"></a>Email</h2>
<h3 id="设计-1"><a href="#设计-1" class="headerlink" title="设计"></a>设计</h3>
<p>因特网的电子邮件系统有三个重要组件</p>
<ul>
<li><strong>用户代理</strong>(user agent)：常见的用户代理有微软的Outlook，Apple Mail等，用户代理允许用户阅读，回复，转发，保存，编辑邮件消息，用户经由代理发送写好的邮件给服务器；</li>
<li><strong>邮件服务器</strong>(mail server)：电子邮件体系的核心，每个接收方在某个邮件服务器上有一个<strong>邮箱</strong>(mailbox)；邮件服务器维护一个<strong>外出报文队列</strong>(outgoing message queue)，用于处理故障等；</li>
<li><strong>简单邮件传输协议</strong>(simple mail transfer protocol, SMTP)：作为邮件的主要应用层协议，采取TCP可靠数据传输服务，实现邮件服务器之间的互发消息；</li>
</ul>
<p><img src="/assets/Computer-Network/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6.png" alt=""></p>
<p>值得注意的，与HTTP协议相比，</p>
<ul>
<li>SMTP采取持久连接；而HTTP对于两类连接都有设计；</li>
<li>HTTP一类典型的PULL协议，而SMTP是典型的PUSH协议；</li>
<li>都有ASCII命令和应答交互，状态码的设计；</li>
<li>HTTP把Web对象封装到HTTP消息中，而SMTP将邮件中的对象置于同一个邮件消息的多目部分发送；</li>
</ul>
<h3 id="SMTP"><a href="#SMTP" class="headerlink" title="SMTP"></a>SMTP</h3>
<p>客户采用TCP来将邮件消息直接发送到服务器端口号25，有如下三个步骤</p>
<ul>
<li>握手：介绍双方基本信息，其中命令和应答交互的交互方式仍为ASCII文本和状态码短语；</li>
<li>邮件消息的传输：SMTP规定必须是7bitASCII码，这是一个比较陈旧的特性；</li>
<li>结束</li>
</ul>
<p>一个邮件的发送和接收过程如下图所示</p>
<ol>
<li>发信人调用用户代理来编辑要发送的邮件。用户代理用 SMTP 把邮件传送给发送端邮件服务器。</li>
<li>发送端邮件服务器将邮件放入邮件缓存队列中，等待发送。</li>
<li>运行在发送端邮件服务器的 SMTP 客户进程，发现在邮件缓存中有待发送的邮件，就向运行在接收端邮件服务器的 SMTP 服务器进程发起 TCP 连接的建立。若对方没有开机，则会稍后尝试；</li>
<li>TCP 连接建立后，SMTP 客户进程开始向远程的 SMTP 服务器进程发送邮件。当所有的待发送邮件发完了，SMTP 就关闭所建立的 TCP 连接。</li>
<li>运行在接收端邮件服务器中的 SMTP 服务器进程收到邮件后，将邮件放入收信人的用户邮箱中，等待收信人在方便时进行读取。</li>
<li>收信人在打算收信时，调用用户代理，使用 POP3（或 IMAP）协议将自己的邮件从接收端邮件服务器的用户邮箱中的取回（如果邮箱中有来信的话）。</li>
</ol>
<p><img src="/assets/Computer-Network/%E7%94%B5%E5%AD%90%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E5%92%8C%E6%8E%A5%E6%94%B6%E7%9A%84%E8%BF%87%E7%A8%8B.png" alt=""></p>
<h3 id="指令-应答"><a href="#指令-应答" class="headerlink" title="指令 &amp; 应答"></a>指令 &amp; 应答</h3>
<p>下表是常见的指令对应的短语含义</p>
<table>
<thead>
<tr>
<th style="text-align:left">命令</th>
<th style="text-align:left">说明</th>
<th style="text-align:left">备注</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>HELO</code></td>
<td style="text-align:left">邮件服务器标志用户身份</td>
<td style="text-align:left">发送者欺骗说谎，伪造合法服务器身份</td>
</tr>
<tr>
<td style="text-align:left"><code>MAIL FROM</code></td>
<td style="text-align:left">指定发件人地址</td>
<td style="text-align:left">伪造成合法用户身份</td>
</tr>
<tr>
<td style="text-align:left"><code>RCPT TO</code></td>
<td style="text-align:left">标志单个收件人地址，可有多个 <code>RCPT TO</code></td>
<td style="text-align:left">伪造收件人地址，如使用字典攻击或利用工具收集合法用户的邮箱地址</td>
</tr>
<tr>
<td style="text-align:left"><code>DATA</code></td>
<td style="text-align:left">初始化数据传输并以 CRLF 结束</td>
<td style="text-align:left">基于内容的垃圾邮件</td>
</tr>
<tr>
<td style="text-align:left"><code>QUIT</code></td>
<td style="text-align:left">结束会话</td>
<td style="text-align:left"></td>
</tr>
</tbody>
</table>
<h3 id="邮件消息的格式"><a href="#邮件消息的格式" class="headerlink" title="邮件消息的格式"></a>邮件消息的格式</h3>
<p>SMTP是用于交换邮件消息的协议，RFC822定义了文本邮件格式的标准。一个RFC822消息包含：</p>
<ul>
<li><strong>头部 (Headers)</strong>：由一系列"字段名: 字段体"对组成，每个字段占据一行，用于描述邮件的元数据，例如发件人（From）、收件人（To）、主题（Subject）、日期（Date）等。
<ul>
<li><strong>字段名</strong>：标识字段的类型（如 <code>From</code>, <code>To</code>, <code>Subject</code>）。</li>
<li><strong>字段体</strong>：包含字段的实际内容。</li>
<li><strong>空行</strong>：一个空行（CRLF）表示头部的结束，将头部与邮件体分开。</li>
</ul>
</li>
<li><strong>邮件体 (Body)</strong>：包含实际的邮件内容，可以是纯文本。RFC822最初只支持7位ASCII文本。</li>
</ul>
<p><strong>多用途Internet邮件拓展</strong>(Multipurpose Internet Mail Extensions, MIME)在RFC2045中提出，用于邮件内容的多媒体拓展，它扩展了RFC822的限制，允许邮件包含：</p>
<ul>
<li>非ASCII字符集：支持除ASCII之外的字符集，如UTF-8，使得邮件可以包含各种语言的文本。</li>
<li>非文本内容：支持在邮件中嵌入图片、音频、视频、应用程序文件等多种二进制数据类型。</li>
<li>多部分邮件：允许将邮件内容分成多个"部分"（parts），每个部分可以有不同的内容类型和编码方式，这些部分可以按层级结构组织。</li>
</ul>
<p>MIME通过在邮件头部添加额外的字段来描述邮件内容的类型和编码，主要包括：</p>
<ul>
<li><strong><code>MIME-Version</code></strong>：指示邮件遵循MIME标准，通常为 <code>1.0</code>。</li>
<li><strong><code>Content-Type</code></strong>：描述邮件或邮件部分的媒体类型和子类型（如 <code>text/plain</code>, <code>text/html</code>, <code>image/jpeg</code>, <code>application/pdf</code>, <code>multipart/mixed</code> 等），并可包含参数，如字符集 (<code>charset</code>)。</li>
<li><strong><code>Content-Transfer-Encoding</code></strong>：指定邮件体或部分内容的编码方式，以确保二进制数据能通过只支持文本的邮件系统传输（如 <code>base64</code>, <code>quoted-printable</code>, <code>7bit</code>, <code>8bit</code>, <code>binary</code>）。</li>
<li><strong><code>Content-Disposition</code></strong>：指示邮件内容的呈现方式，是作为附件 (<code>attachment</code>) 还是内联显示 (<code>inline</code>)。</li>
</ul>
<p><img src="/assets/Computer-Network/MIME%E9%82%AE%E4%BB%B6%E7%9A%84%E5%A4%9A%E5%AA%92%E4%BD%93%E6%8B%93%E5%B1%95.png" alt=""></p>
<h3 id="邮件访问协议"><a href="#邮件访问协议" class="headerlink" title="邮件访问协议"></a>邮件访问协议</h3>
<p>邮件访问协议设计为用户代理从邮件服务器获取邮件消息的任务，主流的协议有如下几类：</p>
<ul>
<li>POP: 邮局协议(Post Office Protocol )[RFC 1939]110端口号，需要代理与服务器的身份认证并下载邮件消息</li>
<li>IMAP: Internet Mail Access Protocol [RFC 1730]，更多功能特征
允许用户像对待本地邮箱那样操纵远程邮箱的邮件</li>
<li>HTTP: Hotmail , Yahoo! Mail, etc.</li>
</ul>
<p><img src="/assets/Computer-Network/%E9%82%AE%E4%BB%B6%E8%AE%BF%E9%97%AE%E5%8D%8F%E8%AE%AE.png" alt=""></p>
<p>例如在POP3协议中，<strong>身份认证阶段</strong>(authorization phase)可能包含如下命令和应答</p>
<ul>
<li>客户命令: <code>user username</code> 和<code>pass password</code>等</li>
<li>服务器响应：<code>+OK</code>和<code>-ERR</code>等</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">S: +OK POP3 server ready </span><br><span class="line">C: user bob </span><br><span class="line">S: +OK </span><br><span class="line">C: pass hungry </span><br><span class="line">S: +OK user successfully logged on</span><br></pre></td></tr></table></figure>
<p>而<strong>传输阶段</strong>(transaction phase)可能包括如下过程</p>
<ul>
<li><code>list</code>: 列出邮件编号</li>
<li><code>retr</code>: 按编号取邮件</li>
<li><code>dele</code>: 删除</li>
<li><code>quit</code></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">C: list </span><br><span class="line">S: 1 498 </span><br><span class="line">S: 2 912 </span><br><span class="line">S: . </span><br><span class="line">C: retr 1 </span><br><span class="line">S: &lt;message 1 contents&gt;</span><br><span class="line">S: . </span><br><span class="line">C: dele 1 </span><br><span class="line">C: retr 2 </span><br><span class="line">S: &lt;message 1 contents&gt;</span><br><span class="line">S: . </span><br><span class="line">C: dele 2 </span><br><span class="line">C: quit </span><br><span class="line">S: +OK POP3 server signing off</span><br></pre></td></tr></table></figure>
<p>POP3的会话是无状态的，POP3还区分如下两类模式，</p>
<ul>
<li><code>Download-and-delete</code>换客户端后不能再读邮件</li>
<li><code>Download-and-keep</code>在不同客户机上的邮件拷贝</li>
</ul>
<p>而IMAP允许用户直接在服务器的各文件夹中管理邮件消息</p>
<ul>
<li>保存所有邮件消息在服务器；</li>
<li>IMAP跟踪用户会话的状态信息；</li>
<li>文件夹和邮件消息IDs与文件夹名字的映射</li>
</ul>
<h2 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h2>
<p>互联网上的主机一般通过便于记忆的<strong>主机名</strong>(hostname)或者IP地址来标识，<strong>域名系统</strong>(domain name system,DNS)负责将主机名映射到IP地址，其组件如下：</p>
<ul>
<li>一个有分层的DNS服务器实现的分布式数据库；</li>
<li>一个使得主机查询数据库的应用层协议；</li>
</ul>
<p>DNS必须是分布式的，而不是集中式的，因为集中式可能带来的单点故障，巨大访问量，难以维护导致的不可拓展问题；</p>
<h3 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h3>
<p>一个DNS服务器通常是运行在软件BIND(Berkeley Internet Name Domain)的UNIX机器；DNS规范中在RFC1034中定义</p>
<ul>
<li>它依靠的运输层协议是UDP；</li>
<li>运行在53号端口上；</li>
<li>采用C/S架构，但不直接和用户打交道，而是为其他应用程序提供域名解析的功能，为其他应用层协议使用；</li>
</ul>
<p>简而言之，DNS服务器提供的服务可概括为</p>
<ol>
<li>主机名到IP地址的映射；</li>
<li>主机别名：一个主机拥有一个规范主机名和多个主机别名；</li>
<li>邮件服务器别名；</li>
<li>负载分配：通过冗余服务器实现，将一个IP地址结合对应于同一个规范主机别名；</li>
</ol>
<p>有三种类型的DNS服务器，这些大量的DNS服务器以层次的方式组织成分布式数据库，注意没有一台DNS服务区具有Internet上所有主机的映射；如图所示</p>
<ul>
<li><strong>根DNS服务器</strong>(root name)：根名字服务器负责记录顶级域名服务器的信息</li>
<li><strong>顶级域DNS服务器</strong>(top-level domain, TLD)：负责顶级域名 <code>com, org, net, edu</code>, etc, 和所有国家的顶级域名 <code>uk, fr, ca, jp</code>.比如Network solutions 公司维护com顶级域的TLD服务器和Educause 公司维护edu顶级域的 TLD服务器</li>
<li><strong>权威DNS服务器</strong>：多数大学和公司维护它们的基本权威DNS服务器。在因特网上具有公共可访问主机（如Web服务器和邮件服务器）的每个组织机构必须提供公共可访问的DNS记录，这些记录将这些主机的名字映射为IP地址。组织机构的权威DNS服务器负责保存这些DNS记录。</li>
</ul>
<p><img src="/assets/Computer-Network/DNS%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84.png" alt=""></p>
<p>本地DNS服务器一般不认为属于层次结构中，每个ISP都会有一个DNS服务器，也是默认服务器；当主机发出DNS请求时，将首先发往本地DNS服务器，起代理的作用，转发请求到层次结构中；</p>
<h3 id="层次树命名"><a href="#层次树命名" class="headerlink" title="层次树命名"></a>层次树命名</h3>
<p>连接在Internet上的主机（包括路由器）对应一个<strong>域名</strong>(domain name)；由若干分量组成，用点隔开<code>*.三级域名.二级域名.顶级域名</code></p>
<p>这种层次结构对应了DNS服务器的层次结构；这样的结构解决了扩展性问题；</p>
<p>一个客户机查询主机名IP地址的自顶向下的示例过程和示例图如下：</p>
<ol>
<li>客户机递归查询根服务器得到<code>dns.edu</code> DNS服务器</li>
<li>客户机迭代查询<code>dns.edu</code> 服务器得到<code>dns.cs.umass.edu</code> 服务器</li>
<li>客户机迭代查询<code>dns.cs.umass.edu</code> 服务器得到<code>gaia.cs.umass.edu</code>的IP地址</li>
</ol>
<p><img src="/assets/Computer-Network/DNS%E6%9F%A5%E8%AF%A2IP%E6%B5%81%E7%A8%8B.png" alt=""></p>
<h3 id="缓存"><a href="#缓存" class="headerlink" title="缓存"></a>缓存</h3>
<p><strong>DNS缓存</strong>(DNS caching)技术用于改善时延性能和减少Internet上传输的DNS报文数量，直接的结果就是根DNS服务器不会被大量经常访问；</p>
<ul>
<li>一旦名字服务器获得DNS映射, 它将缓存该映射到局部内存</li>
<li>服务器在一定时间后将丢弃缓存的信息</li>
<li><strong>本地DNS服务器</strong>可以缓存TLD服务器的IP地址</li>
</ul>
<p>IETF在RFC 2136中正在设计动态更新/通报机制；</p>
<h3 id="记录"><a href="#记录" class="headerlink" title="记录"></a>记录</h3>
<p>DNS作为数据库的一种，我们也关心其记录是什么格式的，有关内容记录在RFC1034中；</p>
<p><strong>资源记录</strong>(resource record,RR)存储在DNS服务器中，其格式为具有如下形式的四元组：<code>(NAME, VALUE, TYPE, TTL)</code></p>
<p>TTL (Time To Live)是该记录的生存时间，指示该记录在DNS服务器中缓存多长时间（秒）。其余的字段的有一种对应关系，如下表所示</p>
<table>
<thead>
<tr>
<th style="text-align:left">类型 (Type)</th>
<th style="text-align:left">名称 (Name)</th>
<th style="text-align:left">值 (Value)</th>
<th style="text-align:left">描述 (Description)</th>
<th style="text-align:left">示例 (Example)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>A</code></td>
<td style="text-align:left">主机名</td>
<td style="text-align:left">IP地址</td>
<td style="text-align:left">将主机名映射到对应的IP地址</td>
<td style="text-align:left"><code>(gaia.cs.umass.edu, 128.119.245.12, A, TTL)</code></td>
</tr>
<tr>
<td style="text-align:left"><code>NS</code></td>
<td style="text-align:left">域</td>
<td style="text-align:left">权威DNS服务器的主机名</td>
<td style="text-align:left">标识该域的权威DNS服务器</td>
<td style="text-align:left"><code>(foo.com, dns.foo.com, NS, TTL)</code></td>
</tr>
<tr>
<td style="text-align:left"><code>CNAME</code></td>
<td style="text-align:left">别名主机名</td>
<td style="text-align:left">规范主机名</td>
<td style="text-align:left">将别名主机名映射到其规范主机名。别名主机名不能有其他记录</td>
<td style="text-align:left"><code>(www.foo.com, foo.com, CNAME, TTL)</code></td>
</tr>
<tr>
<td style="text-align:left"><code>MX</code></td>
<td style="text-align:left">邮件服务器的别名</td>
<td style="text-align:left">邮件服务器的规范主机名</td>
<td style="text-align:left">允许一个公司的邮件服务器和Web服务器使用同一个别名</td>
<td style="text-align:left"><code>(foo.com, mail.bar.blop.com, MX, TTL)</code></td>
</tr>
</tbody>
</table>
<p>这些不同类型的记录对应不同场景下在DNS数据库插入记录的操作</p>
<ul>
<li>
<p>如果你想在注册登记机构注册你的域名<code>example.com</code>，则
需要提供你自己的基本权威DNS服务器和辅助权威DNS服务器的名字和IP地址</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(example.com, dns1.example.com, NS)</span><br><span class="line">(dns1.example.com, 212.212.212.1, A)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>建立一个网站，则可以将网址<code>www.example.com</code>以类型<code>A</code>的方式记录到你的权威DNS服务器<code>dns1.example.com</code>中。</p>
</li>
<li>
<p>建一个邮件服务器，则可以将<code>mail.example.com</code>以类型<code>MX</code>的方式记录到你的权威DNS服务器<code>dns1.example.com</code>中。</p>
</li>
</ul>
<h3 id="消息"><a href="#消息" class="headerlink" title="消息"></a>消息</h3>
<p>DNS的查询报文和应答报文具有相同的格式，如图所示，前12字节为首部区域；</p>
<ul>
<li>标识符：16比特，查询和应答报文使用相同的标识符；</li>
<li>标志：有若干标识位代表不同功能
<ol>
<li>查询/应答－0/ 1</li>
<li>查询希望是/非递归查询－1/0</li>
<li>应答可/否获得(支持)递归查询－1/0</li>
<li>应答是/否来自权威名字服务器－1/ 0</li>
</ol>
</li>
<li>问题部分：查询的<code>Name, type</code>;</li>
<li>回答部分：对于查询,应答的资源记录，可以多个资源记录，由于可以有多个IP地址</li>
<li>权威部分：权威名字服务器的其他资源记录</li>
<li>附加信息部分：其他有帮助的记录.</li>
</ul>
<p><img src="/assets/Computer-Network/DNS%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F.png" alt=""></p>
<h2 id="P2P"><a href="#P2P" class="headerlink" title="P2P"></a>P2P</h2>
<p>有一类非常自然的P2P应用，比如发布操作系统的更新，游戏的补丁；这些用户数量巨大，全部交由服务器是不现实的，在P2P文件分发中，每个对等方向其他对等方发送它接收到文件的部分；</p>
<h3 id="设计-2"><a href="#设计-2" class="headerlink" title="设计"></a>设计</h3>
<p><strong>点对点网络</strong>(Peer-to-Peer, P2P)是一种去中心化的网络架构，其中对等方直接相互交互，无需依赖中央服务器或中心机构。</p>
<p>在P2P网络中，每个对等方既充当客户端，也充当服务器，从而能够直接与其他对等方共享资源和服务。</p>
<p>这样的设计带来了如下的特点：</p>
<ul>
<li>去中心化</li>
<li>资源共享</li>
<li>直接通信</li>
<li>可伸缩性</li>
<li>容错性和冗余</li>
<li>隐私和安全性......</li>
</ul>
<h3 id="内容分发时间"><a href="#内容分发时间" class="headerlink" title="内容分发时间"></a>内容分发时间</h3>
<p>在文件分发场景中，P2P架构与传统的客户端-服务器（C/S）架构在内容分发时间上存在显著差异。假设要分发一个大小为 <code>F</code> 比特的文件给 <code>N</code> 个对等方。</p>
<p>在C/S架构中，文件分发由一个中央服务器独立完成，所有对等方都从该服务器下载文件。分发时间 <code>Dcs</code>的下限由以下两个因素决定：</p>
<ul>
<li><strong>服务器上传能力限制</strong>：服务器必须将文件的 <code>N</code> 份副本上传给 <code>N</code> 个对等方。如果服务器的上传速率为 <code>Us</code>，则至少需要 <code>N * F / Us</code> 的时间。</li>
<li><strong>最慢客户端下载能力限制</strong>：所有 <code>N</code> 个对等方都必须下载文件的完整副本。如果所有对等方中下载速率最慢的为 <code>Dmin</code>，则最慢的对等方至少需要 <code>F / Dmin</code> 的时间来下载文件。</li>
</ul>
<p>综合以上两点，客户端-服务器架构下的最小分发时间为：</p>
<p><span style="margin-left: 50%; transform: translateX(-50%); display: inline-block; "><svg style="vertical-align: -1.909ex;" xmlns="http://www.w3.org/2000/svg" width="24.672ex" height="4.984ex" role="img" focusable="false" viewBox="0 -1359 10905.1 2202.8" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-1-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-1-TEX-I-1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z"></path><path id="MJX-1-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-1-TEX-N-2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path><path id="MJX-1-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-1-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-1-TEX-N-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path><path id="MJX-1-TEX-N-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path id="MJX-1-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-1-TEX-I-1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path><path id="MJX-1-TEX-I-1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path><path id="MJX-1-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-1-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-1-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-1-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-1-TEX-N-7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-1-TEX-I-1D437"></use></g><g data-mml-node="TeXAtom" transform="translate(861,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D450" xlink:href="#MJX-1-TEX-I-1D450"></use></g><g data-mml-node="mi" transform="translate(433,0)"><use data-c="1D460" xlink:href="#MJX-1-TEX-I-1D460"></use></g></g></g><g data-mml-node="mo" transform="translate(1826.6,0)"><use data-c="2265" xlink:href="#MJX-1-TEX-N-2265"></use></g><g data-mml-node="mo" transform="translate(2882.4,0)"><use data-c="6D" xlink:href="#MJX-1-TEX-N-6D"></use><use data-c="61" xlink:href="#MJX-1-TEX-N-61" transform="translate(833,0)"></use><use data-c="78" xlink:href="#MJX-1-TEX-N-78" transform="translate(1333,0)"></use></g><g data-mml-node="mo" transform="translate(4743.4,0)"><use data-c="7B" xlink:href="#MJX-1-TEX-N-7B"></use></g><g data-mml-node="mfrac" transform="translate(5243.4,0)"><g data-mml-node="mrow" transform="translate(220,676)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-1-TEX-I-1D441"></use></g><g data-mml-node="mi" transform="translate(888,0)"><use data-c="1D439" xlink:href="#MJX-1-TEX-I-1D439"></use></g></g><g data-mml-node="msub" transform="translate(489.7,-686)"><g data-mml-node="mi"><use data-c="1D448" xlink:href="#MJX-1-TEX-I-1D448"></use></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-1-TEX-I-1D460"></use></g></g><rect width="1837" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(7320.4,0)"><use data-c="2C" xlink:href="#MJX-1-TEX-N-2C"></use></g><g data-mml-node="mfrac" transform="translate(7765,0)"><g data-mml-node="mi" transform="translate(945.5,676)"><use data-c="1D439" xlink:href="#MJX-1-TEX-I-1D439"></use></g><g data-mml-node="msub" transform="translate(220,-686)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-1-TEX-I-1D437"></use></g><g data-mml-node="TeXAtom" transform="translate(861,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-1-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(878,0)"><use data-c="1D456" xlink:href="#MJX-1-TEX-I-1D456"></use></g><g data-mml-node="mi" transform="translate(1223,0)"><use data-c="1D45B" xlink:href="#MJX-1-TEX-I-1D45B"></use></g></g></g><rect width="2400.1" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(10405.1,0)"><use data-c="7D" xlink:href="#MJX-1-TEX-N-7D"></use></g></g></g></svg></span></p>
<p>对于足够大的 <code>N</code>，<code>Dcs</code> 倾向于由服务器上传能力限制，即 <code>N * F / Us</code>。这意味着分发时间将随对等方数量 <code>N</code> 线性增长，这在用户数量庞大时会成为瓶颈。</p>
<p>在P2P架构中，每个对等方在下载文件的同时，也可以将已下载的部分上传给其他对等方，从而协助分发。分发时间 <code>Dp2p</code>（P2P Distribution Time）的下限由以下三个因素决定：</p>
<ul>
<li><strong>服务器上传能力限制</strong>：与C/S架构类似，服务器至少需要将文件初始上传一次，时间为 <code>F / Us</code>。</li>
<li><strong>最慢对等方下载能力限制</strong>：与C/S架构类似，最慢的对等方至少需要 <code>F / Dmin</code> 的时间来下载文件。</li>
<li><strong>整个系统总上传能力限制</strong>：为了将文件的 <code>N</code> 份副本分发给 <code>N</code> 个对等方，系统总共需要传输 <code>N * F</code> 比特的数据。这些数据由服务器和所有对等方共同上传。如果系统总上传速率为 <code>Utotal</code>（即服务器上传速率 <code>Us</code> 加上所有对等方上传速率 <code>Ui</code> 的总和），则至少需要 <code>N * F / Utotal</code> 的时间。</li>
</ul>
<p>综合以上三点，P2P架构下的最小分发时间为：</p>
<p><span style="margin-left: 50%; transform: translateX(-50%); display: inline-block; "><svg style="vertical-align: -1.909ex;" xmlns="http://www.w3.org/2000/svg" width="31.407ex" height="4.984ex" role="img" focusable="false" viewBox="0 -1359 13881.7 2202.8" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-2-TEX-I-1D437" d="M287 628Q287 635 230 637Q207 637 200 638T193 647Q193 655 197 667T204 682Q206 683 403 683Q570 682 590 682T630 676Q702 659 752 597T803 431Q803 275 696 151T444 3L430 1L236 0H125H72Q48 0 41 2T33 11Q33 13 36 25Q40 41 44 43T67 46Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628ZM703 469Q703 507 692 537T666 584T629 613T590 629T555 636Q553 636 541 636T512 636T479 637H436Q392 637 386 627Q384 623 313 339T242 52Q242 48 253 48T330 47Q335 47 349 47T373 46Q499 46 581 128Q617 164 640 212T683 339T703 469Z"></path><path id="MJX-2-TEX-I-1D45D" d="M23 287Q24 290 25 295T30 317T40 348T55 381T75 411T101 433T134 442Q209 442 230 378L240 387Q302 442 358 442Q423 442 460 395T497 281Q497 173 421 82T249 -10Q227 -10 210 -4Q199 1 187 11T168 28L161 36Q160 35 139 -51T118 -138Q118 -144 126 -145T163 -148H188Q194 -155 194 -157T191 -175Q188 -187 185 -190T172 -194Q170 -194 161 -194T127 -193T65 -192Q-5 -192 -24 -194H-32Q-39 -187 -39 -183Q-37 -156 -26 -148H-6Q28 -147 33 -136Q36 -130 94 103T155 350Q156 355 156 364Q156 405 131 405Q109 405 94 377T71 316T59 280Q57 278 43 278H29Q23 284 23 287ZM178 102Q200 26 252 26Q282 26 310 49T356 107Q374 141 392 215T411 325V331Q411 405 350 405Q339 405 328 402T306 393T286 380T269 365T254 350T243 336T235 326L232 322Q232 321 229 308T218 264T204 212Q178 106 178 102Z"></path><path id="MJX-2-TEX-N-32" d="M109 429Q82 429 66 447T50 491Q50 562 103 614T235 666Q326 666 387 610T449 465Q449 422 429 383T381 315T301 241Q265 210 201 149L142 93L218 92Q375 92 385 97Q392 99 409 186V189H449V186Q448 183 436 95T421 3V0H50V19V31Q50 38 56 46T86 81Q115 113 136 137Q145 147 170 174T204 211T233 244T261 278T284 308T305 340T320 369T333 401T340 431T343 464Q343 527 309 573T212 619Q179 619 154 602T119 569T109 550Q109 549 114 549Q132 549 151 535T170 489Q170 464 154 447T109 429Z"></path><path id="MJX-2-TEX-N-2265" d="M83 616Q83 624 89 630T99 636Q107 636 253 568T543 431T687 361Q694 356 694 346T687 331Q685 329 395 192L107 56H101Q83 58 83 76Q83 77 83 79Q82 86 98 95Q117 105 248 167Q326 204 378 228L626 346L360 472Q291 505 200 548Q112 589 98 597T83 616ZM84 -118Q84 -108 99 -98H678Q694 -104 694 -118Q694 -130 679 -138H98Q84 -131 84 -118Z"></path><path id="MJX-2-TEX-N-6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z"></path><path id="MJX-2-TEX-N-61" d="M137 305T115 305T78 320T63 359Q63 394 97 421T218 448Q291 448 336 416T396 340Q401 326 401 309T402 194V124Q402 76 407 58T428 40Q443 40 448 56T453 109V145H493V106Q492 66 490 59Q481 29 455 12T400 -6T353 12T329 54V58L327 55Q325 52 322 49T314 40T302 29T287 17T269 6T247 -2T221 -8T190 -11Q130 -11 82 20T34 107Q34 128 41 147T68 188T116 225T194 253T304 268H318V290Q318 324 312 340Q290 411 215 411Q197 411 181 410T156 406T148 403Q170 388 170 359Q170 334 154 320ZM126 106Q126 75 150 51T209 26Q247 26 276 49T315 109Q317 116 318 175Q318 233 317 233Q309 233 296 232T251 223T193 203T147 166T126 106Z"></path><path id="MJX-2-TEX-N-78" d="M201 0Q189 3 102 3Q26 3 17 0H11V46H25Q48 47 67 52T96 61T121 78T139 96T160 122T180 150L226 210L168 288Q159 301 149 315T133 336T122 351T113 363T107 370T100 376T94 379T88 381T80 383Q74 383 44 385H16V431H23Q59 429 126 429Q219 429 229 431H237V385Q201 381 201 369Q201 367 211 353T239 315T268 274L272 270L297 304Q329 345 329 358Q329 364 327 369T322 376T317 380T310 384L307 385H302V431H309Q324 428 408 428Q487 428 493 431H499V385H492Q443 385 411 368Q394 360 377 341T312 257L296 236L358 151Q424 61 429 57T446 50Q464 46 499 46H516V0H510H502Q494 1 482 1T457 2T432 2T414 3Q403 3 377 3T327 1L304 0H295V46H298Q309 46 320 51T331 63Q331 65 291 120L250 175Q249 174 219 133T185 88Q181 83 181 74Q181 63 188 55T206 46Q208 46 208 23V0H201Z"></path><path id="MJX-2-TEX-N-7B" d="M434 -231Q434 -244 428 -250H410Q281 -250 230 -184Q225 -177 222 -172T217 -161T213 -148T211 -133T210 -111T209 -84T209 -47T209 0Q209 21 209 53Q208 142 204 153Q203 154 203 155Q189 191 153 211T82 231Q71 231 68 234T65 250T68 266T82 269Q116 269 152 289T203 345Q208 356 208 377T209 529V579Q209 634 215 656T244 698Q270 724 324 740Q361 748 377 749Q379 749 390 749T408 750H428Q434 744 434 732Q434 719 431 716Q429 713 415 713Q362 710 332 689T296 647Q291 634 291 499V417Q291 370 288 353T271 314Q240 271 184 255L170 250L184 245Q202 239 220 230T262 196T290 137Q291 131 291 1Q291 -134 296 -147Q306 -174 339 -192T415 -213Q429 -213 431 -216Q434 -219 434 -231Z"></path><path id="MJX-2-TEX-I-1D439" d="M48 1Q31 1 31 11Q31 13 34 25Q38 41 42 43T65 46Q92 46 125 49Q139 52 144 61Q146 66 215 342T285 622Q285 629 281 629Q273 632 228 634H197Q191 640 191 642T193 659Q197 676 203 680H742Q749 676 749 669Q749 664 736 557T722 447Q720 440 702 440H690Q683 445 683 453Q683 454 686 477T689 530Q689 560 682 579T663 610T626 626T575 633T503 634H480Q398 633 393 631Q388 629 386 623Q385 622 352 492L320 363H375Q378 363 398 363T426 364T448 367T472 374T489 386Q502 398 511 419T524 457T529 475Q532 480 548 480H560Q567 475 567 470Q567 467 536 339T502 207Q500 200 482 200H470Q463 206 463 212Q463 215 468 234T473 274Q473 303 453 310T364 317H309L277 190Q245 66 245 60Q245 46 334 46H359Q365 40 365 39T363 19Q359 6 353 0H336Q295 2 185 2Q120 2 86 2T48 1Z"></path><path id="MJX-2-TEX-I-1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path><path id="MJX-2-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-2-TEX-N-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path id="MJX-2-TEX-I-1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-2-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-2-TEX-I-1D45B" d="M21 287Q22 293 24 303T36 341T56 388T89 425T135 442Q171 442 195 424T225 390T231 369Q231 367 232 367L243 378Q304 442 382 442Q436 442 469 415T503 336T465 179T427 52Q427 26 444 26Q450 26 453 27Q482 32 505 65T540 145Q542 153 560 153Q580 153 580 145Q580 144 576 130Q568 101 554 73T508 17T439 -10Q392 -10 371 17T350 73Q350 92 386 193T423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 180T152 343Q153 348 153 366Q153 405 129 405Q91 405 66 305Q60 285 60 284Q58 278 41 278H27Q21 284 21 287Z"></path><path id="MJX-2-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-2-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-2-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-2-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-2-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJX-2-TEX-N-7D" d="M65 731Q65 745 68 747T88 750Q171 750 216 725T279 670Q288 649 289 635T291 501Q292 362 293 357Q306 312 345 291T417 269Q428 269 431 266T434 250T431 234T417 231Q380 231 345 210T298 157Q293 143 292 121T291 -28V-79Q291 -134 285 -156T256 -198Q202 -250 89 -250Q71 -250 68 -247T65 -230Q65 -224 65 -223T66 -218T69 -214T77 -213Q91 -213 108 -210T146 -200T183 -177T207 -139Q208 -134 209 3L210 139Q223 196 280 230Q315 247 330 250Q305 257 280 270Q225 304 212 352L210 362L209 498Q208 635 207 640Q195 680 154 696T77 713Q68 713 67 716T65 731Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-2-TEX-I-1D437"></use></g><g data-mml-node="TeXAtom" transform="translate(861,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45D" xlink:href="#MJX-2-TEX-I-1D45D"></use></g><g data-mml-node="mn" transform="translate(503,0)"><use data-c="32" xlink:href="#MJX-2-TEX-N-32"></use></g><g data-mml-node="mi" transform="translate(1003,0)"><use data-c="1D45D" xlink:href="#MJX-2-TEX-I-1D45D"></use></g></g></g><g data-mml-node="mo" transform="translate(2253.7,0)"><use data-c="2265" xlink:href="#MJX-2-TEX-N-2265"></use></g><g data-mml-node="mo" transform="translate(3309.5,0)"><use data-c="6D" xlink:href="#MJX-2-TEX-N-6D"></use><use data-c="61" xlink:href="#MJX-2-TEX-N-61" transform="translate(833,0)"></use><use data-c="78" xlink:href="#MJX-2-TEX-N-78" transform="translate(1333,0)"></use></g><g data-mml-node="mo" transform="translate(5170.5,0)"><use data-c="7B" xlink:href="#MJX-2-TEX-N-7B"></use></g><g data-mml-node="mfrac" transform="translate(5670.5,0)"><g data-mml-node="mi" transform="translate(394.3,676)"><use data-c="1D439" xlink:href="#MJX-2-TEX-I-1D439"></use></g><g data-mml-node="msub" transform="translate(220,-686)"><g data-mml-node="mi"><use data-c="1D448" xlink:href="#MJX-2-TEX-I-1D448"></use></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-2-TEX-I-1D460"></use></g></g><rect width="1297.6" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(7208.1,0)"><use data-c="2C" xlink:href="#MJX-2-TEX-N-2C"></use></g><g data-mml-node="mfrac" transform="translate(7652.8,0)"><g data-mml-node="mi" transform="translate(945.5,676)"><use data-c="1D439" xlink:href="#MJX-2-TEX-I-1D439"></use></g><g data-mml-node="msub" transform="translate(220,-686)"><g data-mml-node="mi"><use data-c="1D437" xlink:href="#MJX-2-TEX-I-1D437"></use></g><g data-mml-node="TeXAtom" transform="translate(861,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D45A" xlink:href="#MJX-2-TEX-I-1D45A"></use></g><g data-mml-node="mi" transform="translate(878,0)"><use data-c="1D456" xlink:href="#MJX-2-TEX-I-1D456"></use></g><g data-mml-node="mi" transform="translate(1223,0)"><use data-c="1D45B" xlink:href="#MJX-2-TEX-I-1D45B"></use></g></g></g><rect width="2400.1" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(10292.8,0)"><use data-c="2C" xlink:href="#MJX-2-TEX-N-2C"></use></g><g data-mml-node="mfrac" transform="translate(10737.5,0)"><g data-mml-node="mrow" transform="translate(503.6,676)"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-2-TEX-I-1D441"></use></g><g data-mml-node="mi" transform="translate(888,0)"><use data-c="1D439" xlink:href="#MJX-2-TEX-I-1D439"></use></g></g><g data-mml-node="msub" transform="translate(220,-686)"><g data-mml-node="mi"><use data-c="1D448" xlink:href="#MJX-2-TEX-I-1D448"></use></g><g data-mml-node="TeXAtom" transform="translate(716,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-2-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(361,0)"><use data-c="1D45C" xlink:href="#MJX-2-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(846,0)"><use data-c="1D461" xlink:href="#MJX-2-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(1207,0)"><use data-c="1D44E" xlink:href="#MJX-2-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(1736,0)"><use data-c="1D459" xlink:href="#MJX-2-TEX-I-1D459"></use></g></g></g><rect width="2404.3" height="60" x="120" y="220"></rect></g><g data-mml-node="mo" transform="translate(13381.7,0)"><use data-c="7D" xlink:href="#MJX-2-TEX-N-7D"></use></g></g></g></svg></span></p>
<p>其中，<svg style="vertical-align: -0.777ex;" xmlns="http://www.w3.org/2000/svg" width="21.089ex" height="2.949ex" role="img" focusable="false" viewBox="0 -960 9321.1 1303.3" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><path id="MJX-3-TEX-I-1D448" d="M107 637Q73 637 71 641Q70 643 70 649Q70 673 81 682Q83 683 98 683Q139 681 234 681Q268 681 297 681T342 682T362 682Q378 682 378 672Q378 670 376 658Q371 641 366 638H364Q362 638 359 638T352 638T343 637T334 637Q295 636 284 634T266 623Q265 621 238 518T184 302T154 169Q152 155 152 140Q152 86 183 55T269 24Q336 24 403 69T501 205L552 406Q599 598 599 606Q599 633 535 637Q511 637 511 648Q511 650 513 660Q517 676 519 679T529 683Q532 683 561 682T645 680Q696 680 723 681T752 682Q767 682 767 672Q767 650 759 642Q756 637 737 637Q666 633 648 597Q646 592 598 404Q557 235 548 205Q515 105 433 42T263 -22Q171 -22 116 34T60 167V183Q60 201 115 421Q164 622 164 628Q164 635 107 637Z"></path><path id="MJX-3-TEX-I-1D461" d="M26 385Q19 392 19 395Q19 399 22 411T27 425Q29 430 36 430T87 431H140L159 511Q162 522 166 540T173 566T179 586T187 603T197 615T211 624T229 626Q247 625 254 615T261 596Q261 589 252 549T232 470L222 433Q222 431 272 431H323Q330 424 330 420Q330 398 317 385H210L174 240Q135 80 135 68Q135 26 162 26Q197 26 230 60T283 144Q285 150 288 151T303 153H307Q322 153 322 145Q322 142 319 133Q314 117 301 95T267 48T216 6T155 -11Q125 -11 98 4T59 56Q57 64 57 83V101L92 241Q127 382 128 383Q128 385 77 385H26Z"></path><path id="MJX-3-TEX-I-1D45C" d="M201 -11Q126 -11 80 38T34 156Q34 221 64 279T146 380Q222 441 301 441Q333 441 341 440Q354 437 367 433T402 417T438 387T464 338T476 268Q476 161 390 75T201 -11ZM121 120Q121 70 147 48T206 26Q250 26 289 58T351 142Q360 163 374 216T388 308Q388 352 370 375Q346 405 306 405Q243 405 195 347Q158 303 140 230T121 120Z"></path><path id="MJX-3-TEX-I-1D44E" d="M33 157Q33 258 109 349T280 441Q331 441 370 392Q386 422 416 422Q429 422 439 414T449 394Q449 381 412 234T374 68Q374 43 381 35T402 26Q411 27 422 35Q443 55 463 131Q469 151 473 152Q475 153 483 153H487Q506 153 506 144Q506 138 501 117T481 63T449 13Q436 0 417 -8Q409 -10 393 -10Q359 -10 336 5T306 36L300 51Q299 52 296 50Q294 48 292 46Q233 -10 172 -10Q117 -10 75 30T33 157ZM351 328Q351 334 346 350T323 385T277 405Q242 405 210 374T160 293Q131 214 119 129Q119 126 119 118T118 106Q118 61 136 44T179 26Q217 26 254 59T298 110Q300 114 325 217T351 328Z"></path><path id="MJX-3-TEX-I-1D459" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path id="MJX-3-TEX-N-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path id="MJX-3-TEX-I-1D460" d="M131 289Q131 321 147 354T203 415T300 442Q362 442 390 415T419 355Q419 323 402 308T364 292Q351 292 340 300T328 326Q328 342 337 354T354 372T367 378Q368 378 368 379Q368 382 361 388T336 399T297 405Q249 405 227 379T204 326Q204 301 223 291T278 274T330 259Q396 230 396 163Q396 135 385 107T352 51T289 7T195 -10Q118 -10 86 19T53 87Q53 126 74 143T118 160Q133 160 146 151T160 120Q160 94 142 76T111 58Q109 57 108 57T107 55Q108 52 115 47T146 34T201 27Q237 27 263 38T301 66T318 97T323 122Q323 150 302 164T254 181T195 196T148 231Q131 256 131 289Z"></path><path id="MJX-3-TEX-N-2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z"></path><path id="MJX-3-TEX-SO-2211" d="M61 748Q64 750 489 750H913L954 640Q965 609 976 579T993 533T999 516H979L959 517Q936 579 886 621T777 682Q724 700 655 705T436 710H319Q183 710 183 709Q186 706 348 484T511 259Q517 250 513 244L490 216Q466 188 420 134T330 27L149 -187Q149 -188 362 -188Q388 -188 436 -188T506 -189Q679 -189 778 -162T936 -43Q946 -27 959 6H999L913 -249L489 -250Q65 -250 62 -248Q56 -246 56 -239Q56 -234 118 -161Q186 -81 245 -11L428 206Q428 207 242 462L57 717L56 728Q56 744 61 748Z"></path><path id="MJX-3-TEX-I-1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z"></path><path id="MJX-3-TEX-I-1D456" d="M184 600Q184 624 203 642T247 661Q265 661 277 649T290 619Q290 596 270 577T226 557Q211 557 198 567T184 600ZM21 287Q21 295 30 318T54 369T98 420T158 442Q197 442 223 419T250 357Q250 340 236 301T196 196T154 83Q149 61 149 51Q149 26 166 26Q175 26 185 29T208 43T235 78T260 137Q263 149 265 151T282 153Q302 153 302 143Q302 135 293 112T268 61T223 11T161 -11Q129 -11 102 10T74 74Q74 91 79 106T122 220Q160 321 166 341T173 380Q173 404 156 404H154Q124 404 99 371T61 287Q60 286 59 284T58 281T56 279T53 278T49 278T41 278H27Q21 284 21 287Z"></path><path id="MJX-3-TEX-N-31" d="M213 578L200 573Q186 568 160 563T102 556H83V602H102Q149 604 189 617T245 641T273 663Q275 666 285 666Q294 666 302 660V361L303 61Q310 54 315 52T339 48T401 46H427V0H416Q395 3 257 3Q121 3 100 0H88V46H114Q136 46 152 46T177 47T193 50T201 52T207 57T213 61V578Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="msub"><g data-mml-node="mi"><use data-c="1D448" xlink:href="#MJX-3-TEX-I-1D448"></use></g><g data-mml-node="TeXAtom" transform="translate(716,-150) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D461" xlink:href="#MJX-3-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(361,0)"><use data-c="1D45C" xlink:href="#MJX-3-TEX-I-1D45C"></use></g><g data-mml-node="mi" transform="translate(846,0)"><use data-c="1D461" xlink:href="#MJX-3-TEX-I-1D461"></use></g><g data-mml-node="mi" transform="translate(1207,0)"><use data-c="1D44E" xlink:href="#MJX-3-TEX-I-1D44E"></use></g><g data-mml-node="mi" transform="translate(1736,0)"><use data-c="1D459" xlink:href="#MJX-3-TEX-I-1D459"></use></g></g></g><g data-mml-node="mo" transform="translate(2482,0)"><use data-c="3D" xlink:href="#MJX-3-TEX-N-3D"></use></g><g data-mml-node="msub" transform="translate(3537.8,0)"><g data-mml-node="mi"><use data-c="1D448" xlink:href="#MJX-3-TEX-I-1D448"></use></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><use data-c="1D460" xlink:href="#MJX-3-TEX-I-1D460"></use></g></g><g data-mml-node="mo" transform="translate(4857.7,0)"><use data-c="2B" xlink:href="#MJX-3-TEX-N-2B"></use></g><g data-mml-node="munderover" transform="translate(5857.9,0)"><g data-mml-node="mo"><use data-c="2211" xlink:href="#MJX-3-TEX-SO-2211"></use></g><g data-mml-node="TeXAtom" transform="translate(1089,477.1) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D441" xlink:href="#MJX-3-TEX-I-1D441"></use></g></g><g data-mml-node="TeXAtom" transform="translate(1089,-285.4) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><use data-c="1D456" xlink:href="#MJX-3-TEX-I-1D456"></use></g><g data-mml-node="mo" transform="translate(345,0)"><use data-c="3D" xlink:href="#MJX-3-TEX-N-3D"></use></g><g data-mml-node="mn" transform="translate(1123,0)"><use data-c="31" xlink:href="#MJX-3-TEX-N-31"></use></g></g></g><g data-mml-node="msub" transform="translate(8311.2,0)"><g data-mml-node="mi"><use data-c="1D448" xlink:href="#MJX-3-TEX-I-1D448"></use></g><g data-mml-node="mi" transform="translate(716,-150) scale(0.707)"><use data-c="1D456" xlink:href="#MJX-3-TEX-I-1D456"></use></g></g></g></g></svg>；</p>
<p><img src="/assets/Computer-Network/CS%E6%9E%B6%E6%9E%84%E5%92%8CP2P%E6%9E%B6%E6%9E%84%E5%9C%A8%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E6%97%B6%E9%97%B4%E7%9A%84%E6%AF%94%E8%BE%83.png" alt="image-20250608181935649"></p>
<h3 id="P2P网络优缺点"><a href="#P2P网络优缺点" class="headerlink" title="P2P网络优缺点"></a>P2P网络优缺点</h3>
<p>P2P网络相对于传统的客户端-服务器架构具有以下优点和缺点：</p>
<table>
<thead>
<tr>
<th style="text-align:left">优点 (Advantages)</th>
<th style="text-align:left">缺点 (Disadvantages)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><strong>去中心化和弹性</strong>：没有单点故障，网络更具弹性。</td>
<td style="text-align:left"><strong>缺乏集中控制</strong>：难以管理和协调网络活动，难以执行一致的策略并确保数据完整性。</td>
</tr>
<tr>
<td style="text-align:left"><strong>易于扩展</strong>：随着对等方数量增加，可用资源和能力随之增长，可处理更大的工作负载。</td>
<td style="text-align:left"><strong>网络管理复杂性</strong>：对等方责任均等，网络管理任务（如寻址、安全性、性能优化）必须在参与者之间分配，需要额外的协调和努力。</td>
</tr>
<tr>
<td style="text-align:left"><strong>高效资源利用</strong>：通过在多个对等方之间分配负载，提高资源利用率。</td>
<td style="text-align:left"><strong>依赖对等方可用性</strong>：资源和服务的可用性取决于对等方的活跃参与，如果大量对等方离线或不活跃，可能会影响性能和可用性。</td>
</tr>
<tr>
<td style="text-align:left"><strong>成本节约</strong>：无需昂贵的专用服务器或集中式基础设施，设置和维护成本更低。</td>
<td style="text-align:left"><strong>性能和效率可变性</strong>：P2P网络的性能受参与对等方的数量和质量、可用资源以及网络拓扑等因素的影响，可能导致不可预测的行为。</td>
</tr>
<tr>
<td style="text-align:left"><strong>直接通信和更快的内容交付</strong>：对等方之间直接通信，消除中介，实现更快的交付和实时交互。</td>
<td style="text-align:left"><strong>安全风险</strong>：如果未采取适当预防措施，P2P网络可能会引入安全风险。恶意对等方可能利用网络中的漏洞发起攻击或分发恶意内容。</td>
</tr>
<tr>
<td style="text-align:left"><strong>增强隐私和安全性</strong>：对等方之间直接通信可以加密，保护数据机密性，降低单点攻击的脆弱性。</td>
<td style="text-align:left"><strong>法律和版权问题</strong>：P2P网络与版权侵权和非法共享受版权保护保护材料相关联。虽然P2P技术本身不违法，但它可能促进未经授权的共享，从而引发法律和道德问题。</td>
</tr>
</tbody>
</table>
<h3 id="集中式和非集中式搜索"><a href="#集中式和非集中式搜索" class="headerlink" title="集中式和非集中式搜索"></a>集中式和非集中式搜索</h3>
<p><strong>集中式搜索：Napster</strong></p>
<p>Napster是一个早期的P2P文件共享服务，它使用一个中心服务器来维护所有在线用户的共享文件列表。当用户想要查找文件时，他们会向中心服务器发送查询。服务器返回包含该文件的用户列表，然后用户可以直接从这些用户下载文件。</p>
<p><strong>非集中式搜索：Gnutella</strong></p>
<p>Gnutella是一个<strong>全分布式</strong>的P2P网络协议，没有集中式服务器。它采用<strong>查询洪泛</strong>(query flooding)机制来查找文件。</p>
<ul>
<li><strong>工作原理</strong>：当一个对等方需要查找文件时，它会向其直接连接的对等方发送查询报文。这些对等方会进一步转发该报文给它们的连接对等方，直到达到某个跳数限制或找到文件。匹配的对等方会发送 <code>QueryHit</code> 报文，该报文会沿着反向路径传回发起查询的对等方。</li>
<li><strong>覆盖网络(Overlay Network)</strong>：Gnutella网络中的所有活跃对等方及其TCP连接构成了一个覆盖网络（逻辑图），这些连接不是物理通信链路。通常，一个对等方在覆盖网络中连接的节点数量少于10个。</li>
<li><strong>可扩展性</strong>：为了限制查询洪泛带来的网络负载，Gnutella通常采用<strong>限范围泛洪</strong>（Limited-scope flooding）机制，即查询报文只在有限的跳数内转发。</li>
<li><strong>加入对等方</strong>：新的对等方（如对等方X）加入Gnutella网络时，它需要发现网络中的其他对等方。通常通过使用一个已知的对等方列表。X会尝试与列表上的对等方建立一条TCP连接，直到与某个对等方Y成功连接。X向Y发送一个 <code>Ping</code> 报文；Y转发该 <code>Ping</code> 报文。所有的对等方接收 <code>Ping</code> 报文并响应一个 <code>Pong</code> 报文。X接收到许多 <code>Pong</code> 报文。然后能同某些其他对等方建立TCP连接。</li>
</ul>
<p><img src="/assets/Computer-Network/Gnutella%E5%8D%8F%E8%AE%AE.png" alt="image-20250608182213049"></p>
<h3 id="混合式架构：KaZaA"><a href="#混合式架构：KaZaA" class="headerlink" title="混合式架构：KaZaA"></a>混合式架构：KaZaA</h3>
<p>KaZaA是一种流行的文件共享P2P应用，它采用了<strong>混合式</strong>的P2P架构，结合了集中式和去中心化的特点。它引入了"超级对等方"（Super-peers）或"组长"的概念，这些超级对等方充当了网络的局部索引服务器。</p>
<p><strong>层次结构</strong>：每个对等方要么被指派为"组长"（Super-peer），要么被指派给一个"组长"作为其"子对等方"。</p>
<ul>
<li><strong>对等方与组长之间的连接</strong>：对等方与它们的组长之间建立TCP连接。</li>
<li><strong>组长之间的连接</strong>：组长之间也建立TCP连接，形成一个高层级的覆盖网络。</li>
</ul>
<p><strong>内容管理</strong>：组长负责维护其所有子对等方共享的内容的索引。当子对等方共享文件时，它们会将文件信息（如文件名、大小、哈希值等）报告给其组长。</p>
<p><strong>文件查询</strong>：</p>
<ol>
<li>客户端（对等方）向其组长发送关键词查询。</li>
<li>组长响应匹配的逐项信息，包括元数据、文件的散列值和持有该文件的对等方的IP地址。</li>
<li>如果组长没有找到匹配项，它可能会将查询转发给其他组长，其他组长会响应匹配。</li>
</ol>
<p><strong>文件下载</strong>：客户端选择要下载的文件后，直接向持有该文件的对等方发送HTTP请求（使用文件的哈希值作为标识符）。</p>
<p><strong>下载优化机制</strong>：</p>
<ul>
<li><strong>请求排队</strong>：限制对等方并行上传的数量，新的下载请求进入队列等待。</li>
<li><strong>激励优先权</strong>：根据不同的上传/下载比例优先服务贡献大的对等方，鼓励用户共享资源。</li>
<li><strong>并行下载</strong>：将一个文件分成若干段，从多个对等方并行下载，以提高下载速度。</li>
</ul>
<h2 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h2>
<h3 id="HTTP-stream-DASH"><a href="#HTTP-stream-DASH" class="headerlink" title="HTTP stream &amp; DASH"></a>HTTP stream &amp; DASH</h3>
<p>传统的流媒体（如RTP/RTCP）通常需要专门的流媒体服务器和协议来传输音视频内容。而HTTP流媒体是利用标准的HTTP协议来传输多媒体内容的一种方式。它的主要优势在于可以复用现有的Web基础设施，无需部署额外的流媒体服务器，这大大简化了内容分发。</p>
<p>HTTP流媒体的核心思想是将音视频内容分割成小的、独立的媒体片段，然后通过HTTP协议逐步下载这些片段并在客户端进行播放。这种方式使得内容分发能够充分利用HTTP缓存、CDN等现有技术。</p>
<p>DASH（Dynamic Adaptive Streaming over HTTP），用于通过HTTP传输流媒体内容。它的主要特点是"自适应"，这意味着客户端可以根据网络带宽、CPU负载等条件动态地选择不同质量（比特率、分辨率）的媒体片段进行下载和播放。</p>
<p>原始的音视频内容会被编码成多种不同比特率和分辨率的版本。每个版本再被分割成许多小的、固定或可变长度的媒体片段（通常是几秒钟）。</p>
<p>**媒体演示描述 (Media Presentation Description, MPD)：**一个XML文件作为告示文件，存储在HTTP服务器中，包含了关于所有可用媒体片段的元数据，包括：</p>
<ul>
<li>不同质量版本的URL。</li>
<li>每个片段的时长。</li>
<li>编解码器信息。</li>
<li>内容版权信息等。</li>
</ul>
<p>客户端首先下载MPD文件，然后根据其中的信息来决定下载哪些媒体片段。客户端适应性播放：</p>
<ul>
<li>客户端持续监测当前的网络带宽状况和设备性能。</li>
<li>根据监测结果，客户端会智能地选择下载最适合当前条件的媒体片段。例如，如果网络带宽下降，客户端会自动切换到低比特率的视频片段，以避免卡顿；反之，如果带宽充足，则切换到高比特率以提供更好的观看体验。</li>
<li>客户端会维护一个缓冲区，预先下载一些片段，以应对网络波动。</li>
</ul>
<h3 id="CDN-1"><a href="#CDN-1" class="headerlink" title="CDN"></a>CDN</h3>
<p><strong>内容分发网络</strong>(Content Delivery Network, CDN) 是一个地理上分散的服务器网络，用于高效地向用户分发内容。主要为视频流，网站加速，文件下载等公司采用；它们有些部署自己的CDN，有些采用第三方的服务；</p>
<p><strong>CDN 的工作原理：</strong></p>
<ol>
<li><strong>缓存内容</strong>：当用户首次请求某个内容（如图片、视频、网页、JavaScript 文件等）时，CDN 会从原始服务器（源站）获取该内容，并将其缓存到离用户最近的CDN节点（边缘服务器）上。</li>
<li><strong>就近分发</strong>：大多数CDN利用DNS进行重定向请求，意思是后续用户再次请求相同内容时，如果该内容已经在附近的CDN节点上缓存，CDN 会直接从该节点提供服务，而无需回源到原始服务器。</li>
<li><strong>流量管理</strong>：CDN 能够智能地将用户请求路由到性能最佳的边缘服务器，这通常是地理位置最近或负载最轻的服务器。</li>
<li><strong>负载均衡</strong>：通过将流量分散到多个服务器上，CDN 可以有效地分担源站的压力，防止因高并发访问导致服务器过载。</li>
</ol>
<p><img src="/assets/Computer-Network/CDN%E5%86%85%E5%AE%B9%E5%88%86%E5%8F%91%E8%BF%87%E7%A8%8B.png" alt=""></p>
<p>CDN的部署遵循集群选择策略，动态地将用户定向到CDN中地某个数据中心地机制；可以是基于地理的，或者基于流量的；</p>
<h2 id="套接字编程"><a href="#套接字编程" class="headerlink" title="套接字编程"></a>套接字编程</h2>
<p>套接字（Socket）是网络编程中用于实现进程间通信的一种抽象机制。它作为应用程序与网络协议栈之间的接口，允许程序通过网络发送和接收数据。在计算机网络中，不同主机上的进程通过套接字相互通信。</p>
<p>每个套接字都绑定到一个IP地址和端口号，从而唯一标识网络上的一个进程。</p>
<ul>
<li>IP地址：标识主机在网络中的位置。在<code>Python</code>中用<code>socket.AF_INET</code>作为参数代表<code>IPv4</code>;</li>
<li>端口号：标识主机上运行的特定进程或服务。</li>
</ul>
<h3 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h3>
<p><strong>流套接字</strong>(streaming sockets)使用TCP协议。</p>
<ul>
<li>提供<strong>面向连接</strong>的、<strong>可靠的</strong>、<strong>有序的</strong>、<strong>基于字节流</strong>的数据传输。</li>
<li>在<code>Python</code>中使用<code>SOCK_STREAM</code>作为初始化参数传入；</li>
<li>适用于需要高可靠性、对数据完整性和顺序有严格要求的应用，如Web浏览（HTTP）、文件传输（FTP）和电子邮件（SMTP）。</li>
</ul>
<p>客户端和服务端基本步骤如下：</p>
<p>服务器端基本步骤：</p>
<ol>
<li>
<p>创建套接字：<code>server_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</code></p>
</li>
<li>
<p>（服务端）绑定地址和端口：<code>server_socket.bind(('127.0.0.1', 12345))</code>，用户端不需要；TCP监听连接：<code>server_socket.listen(5)</code>；TCP接受连接：<code>client_socket, client_address = server_socket.accept()</code>用于获得客户端套接字（和客户端的地址。</p>
<p>（用户端）连接服务器：<code>client_socket.connect(('127.0.0.1', 12345))</code></p>
</li>
<li>
<p>发送字节数据：<code>client_socket.sendall(b"Hello from server")</code></p>
</li>
<li>
<p>接收字节数据：<code>data = client_socket.recv(1024)</code></p>
</li>
<li>
<p>关闭套接字：<code>server_socket.close()</code></p>
</li>
</ol>
<h3 id="Datagram"><a href="#Datagram" class="headerlink" title="Datagram"></a>Datagram</h3>
<p><strong>数据报套接字</strong> (Datagram Sockets)使用UDP协议。</p>
<ul>
<li>提供<strong>无连接</strong>的、<strong>不可靠的</strong>、<strong>无序的</strong>数据传输。</li>
<li>在<code>Python</code>中使用<code>SOCK_DGRAM</code>作为初始化参数传入；</li>
<li>适用于对实时性要求高、容忍少量数据丢失的应用，如在线游戏、VoIP（网络电话）和DNS查询。</li>
</ul>
<p>服务器端和用户端基本步骤：</p>
<ol>
<li>
<p>创建套接字：<code>server_socket = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)</code></p>
</li>
<li>
<p>（服务端）绑定地址和端口：<code>server_socket.bind(('127.0.0.1', 12345))</code></p>
<p>（客户端）无操作</p>
</li>
<li>
<p>接收和发送数据：使用 <code>recvfrom()</code> 接收数据（同时获取发送方的地址），使用 <code>sendto()</code> 发送数据（需要指定目标地址）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data, client_address = server_socket.recvfrom(<span class="number">1024</span>)</span><br><span class="line">server_socket.sendto(<span class="string">b&quot;Hello back&quot;</span>, client_address)</span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>关闭套接字</strong>：<code>server_socket.close()</code></p>
</li>
</ol>
</main>


<script src="/js/theme.js"></script>


<script src="/js/code-block-header.js"></script>


<script src="/js/code-block-copy.js"></script>


<script src="/js/code-block-theme-toggle.js"></script>


<script src="/js/code-block.js"></script>



<link rel="stylesheet" href="/css/article.css">

    
    <!-- giscus评论区 -->
    
  <div id="giscus_thread"></div>

  </div>
</article>
  
</main>

      <!-- 页脚 -->
      <footer class="footer">
  
  <span>Copyright © Kytolly(shiroi)</span>
  
  <div class="theme-switch-wrapper">
    <div class="theme-switch">
      <div class="theme-switch-item light-mode active">
        <img src="/icon/light.svg" class="icon">
      </div>
      <div class="theme-switch-item dark-mode">
        <img src="/icon/dark.svg" class="icon">
      </div>
    </div>
  </div>
</footer>


<link rel="stylesheet" href="/css/footer.css">


<script src="/js/theme-switcher.js"></script>


<script src="/js/giscus.js"></script>


      
  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <img src="/icon/search.svg" alt="Search Icon" class="search-icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <img src="/icon/search.svg" alt="Search Icon" style="width:5em;height:5em;">
        </div>
        <ul id="search-results"></ul>
      </div>
    </div>
  </div>

<link rel="stylesheet" href="/css/search.css">



    </div>
    
<script src="/js/background.js"></script>

  </body>

</html>