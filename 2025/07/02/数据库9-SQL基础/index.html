<!DOCTYPE html>
<html>
<meta charset="utf-8" />
  <!-- 标签页 -->
  <!-- 标签页 -->
<title>
    SQL基础
</title>


<link rel="shortcut icon" href="/icon.svg">


  <body>  
    <!-- 配置引用 -->
    <script>
  window.THEME_CONFIG = {
    image: {
      enable: 'true',
      center: 'true',
      caption: 'false'
    },
    code_block: {
      copy_button: "icon/copy.svg",
      theme_toggle: {
        enable: 'true',
        to_light_button: "icon/light.svg",
        to_dark_button: "icon/dark.svg",
        light_theme: "/css/vscode-modern-light.css",
        dark_theme: "/css/vscode-modern-dark.css"
      },
      mac_enhancer: {
        enable: 'true',
        init_folded_status: 'true'
      }
    },
    giscus: {
      repo: "Kytolly/MyGiscus",
      repo_id: "R_kgDOK_0_0A",
      category: "Announcements",
      category_id: "DIC_kwDOK_0_0A",
      mapping: "pathname",
      strict: "0",
      reactions_enabled: "1",
      emit_metadata: "0",
      input_position: "top",
      lang: "zh-CN",
      loading: "lazy"
    },
    heading_numbering: 'true',
    three_line_table: 'true',
    background: {
      enable: 'true',
      folder: 'img/',
      opacity: '0.1',
      position: 'center',
      size: 'cover',
      repeat: 'no-repeat',
      image: {
        mode: 'random',
        name: 'background.jpg',
        count: '113'
      }
    },
  };
</script>
<script>
  console.log(window.THEME_CONFIG);
</script>

<head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    
    <!-- 字体 -->
    <!-- 字体 -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200..900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <!-- 代码块 -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
      
        <link rel="stylesheet" href="/css/vscode-modern-light.css">
        <link rel="stylesheet" href="/css/vscode-modern-dark.css">
        <!-- DEBUG: url_for light path: /css/vscode-modern-light.css -->
        <!-- DEBUG: url_for dark path: /css/vscode-modern-dark.css -->
      
    
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>

    <!-- 数学公式 -->
    
<link rel="stylesheet" href="/css/mathjax.css">

    
<script src="/js/mathjax.js"></script>

    
    <!-- 标题编号 -->
    
      
<link rel="stylesheet" href="/css/heading-numbering.css">

      
<script src="/js/heading-numbering.js"></script>

    
    
    <!-- 三线表样式 -->
    
      
<link rel="stylesheet" href="/css/three-line-table.css">

    
  
    <!-- 图片样式 -->
    
      
<link rel="stylesheet" href="/css/image-handler.css">

      
<script src="/js/image-handler.js"></script>

    
    
  
    
<link rel="stylesheet" href="/css/root.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/post.css">


    <!-- 代码块基础样式 -->
    
<link rel="stylesheet" href="/css/code-block-base.css">

  
    <!-- Codeblock Theme Toggler CSS -->
    
    
<link rel="stylesheet" href="/css/codeblock-theme-toggle.css">

    
  
    <!-- Codeblock Mac Enhancer CSS -->
    
    
<link rel="stylesheet" href="/css/code-block-mac-enhancer.css">

    
  
    <!-- TOC 样式 -->
    <link rel="stylesheet" href="/css/toc.css">
    
  <!-- hexo injector head_end start -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
  <!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0">
</head>


    <div class="site-container">
      <!-- 导航栏 -->
      <!--(头部 top bar) Header 样式 -->

<link rel="stylesheet" href="/css/header.css">


<header class="header">
  <section class="header-container">
    <a class="header-logo" href="/">Kytolly&#39;s Blog</a>
    <div class="header-right-section">
      <ul class="header-nav">
        
        <li>
          <a href="/">
            <img src="/icon/index.svg" alt="index icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            index
          </a>
        </li>
        
        <li>
          <a href="/archive">
            <img src="/icon/archive.svg" alt="archive icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            archive
          </a>
        </li>
        
        <li>
          <a href="/tag">
            <img src="/icon/tag.svg" alt="tag icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            tag
          </a>
        </li>
        
        <li>
          <a href="/about">
            <img src="/icon/about.svg" alt="about icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
            about
          </a>
        </li>
        
      </ul>
      
      
      <div class="header-search-container search-trigger">
        <img src="/icon/search.svg" alt="Search Icon" class="search-icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
        <input type="text" id="header-search-input" placeholder="searching..." readonly>
      </div>
      
    </div>
  </section>
</header>


<script src="/js/search.js"></script>


      <!-- 路由 根据页面类型决定渲染内容 -->
      <main class="main">
  
    <article class="post-container">
  <!-- 可选：左侧跟随目录 -->
  
  <aside id="toc-container" class="toc-container toc-left toc-expanded">
    <div id="toc-title" class="toc-title">SQL基础</div>
    <div id="toc-content" class="toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%B9%E7%82%B9"><span class="toc-number">1.</span> <span class="toc-text">特点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E5%91%BD%E4%BB%A4"><span class="toc-number">2.</span> <span class="toc-text">核心命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">3.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="toc-number">4.</span> <span class="toc-text">聚集函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8E%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0%E7%9A%84%E8%81%94%E7%B3%BB"><span class="toc-number">5.</span> <span class="toc-text">与关系代数的联系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.</span> <span class="toc-text">数据查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">6.1.</span> <span class="toc-text">关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.2.</span> <span class="toc-text">无条件查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.3.</span> <span class="toc-text">条件查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E7%9A%84%E5%88%AB%E5%90%8D"><span class="toc-number">6.4.</span> <span class="toc-text">列的别名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">6.5.</span> <span class="toc-text">查询表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%8C%B9%E9%85%8D"><span class="toc-number">6.6.</span> <span class="toc-text">字符串匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E5%8E%BB%E9%87%8D"><span class="toc-number">6.7.</span> <span class="toc-text">结果去重</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E6%8E%92%E5%BA%8F"><span class="toc-number">6.8.</span> <span class="toc-text">结果排序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.9.</span> <span class="toc-text">统计查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.10.</span> <span class="toc-text">连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.10.1.</span> <span class="toc-text">内连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%80%BC%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.10.2.</span> <span class="toc-text">等值连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E7%84%B6%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.10.3.</span> <span class="toc-text">自然连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.10.4.</span> <span class="toc-text">自连接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">6.10.5.</span> <span class="toc-text">外连接</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2"><span class="toc-number">6.11.</span> <span class="toc-text">嵌套查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B0%93%E8%AF%8D"><span class="toc-number">6.12.</span> <span class="toc-text">谓词</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%9B%B4%E6%96%B0"><span class="toc-number">7.</span> <span class="toc-text">数据更新</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%93%8D%E4%BD%9C"><span class="toc-number">7.1.</span> <span class="toc-text">插入操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E5%8A%A0%E6%93%8D%E4%BD%9C"><span class="toc-number">7.2.</span> <span class="toc-text">增加操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E6%93%8D%E4%BD%9C"><span class="toc-number">7.3.</span> <span class="toc-text">修改操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4"><span class="toc-number">7.4.</span> <span class="toc-text">数据删除</span></a></li></ol></li></ol>
    </div>
  </aside>
 


<script src="/js/toc.js"></script>


  <!-- 可选：右侧 AI 摘要 -->
  

  <div class="post-main-wrapper">
    <!-- 文章 -->
    <div class="post-title">SQL基础</div>
  <div class="post-meta">
    <div class="date">2025 七月 2日</div>
    <div class="tags">
      
        
        <div class="tag-item">Coursework</div>
        
        <div class="tag-item">Database</div>
        
      
    </div>
  </div>

<main class="post-content"><h2 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h2>
<ul>
<li>高度统一：集DDL，DML，DCL于一体</li>
<li>高度非过程化：只需要提出做什么，无需声明怎么做</li>
<li>面向集合的操作：操作的对象和结果均为集合</li>
<li>两种使用方法：自主式使用（CLI，GUI），嵌入式语言</li>
</ul>
<h2 id="核心命令"><a href="#核心命令" class="headerlink" title="核心命令"></a>核心命令</h2>
<ol>
<li>DDL：<code>CREATE DROP ALERT</code></li>
<li>DML:  <code>SELECT INSERT UPDATE DELETE</code></li>
<li>DCL:   <code>GRANT REVOKE</code></li>
</ol>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>声明</th>
</tr>
</thead>
<tbody>
<tr>
<td>数字</td>
<td>NUMERIC，DECIMAL， INTERGER，SMALLINT，FLOAT，DOUBLE，REAL</td>
</tr>
<tr>
<td>字符串</td>
<td>CHAR， VARCHAR， TEXT</td>
</tr>
<tr>
<td>二进制串</td>
<td>BINARY，VARBINARY，BLOB</td>
</tr>
<tr>
<td>布尔类型</td>
<td>BOOLEAN</td>
</tr>
<tr>
<td>日期时间</td>
<td>DATE，TIME，DATETIME，TIMESTAMP</td>
</tr>
<tr>
<td>时间间隔</td>
<td>INTERVAL</td>
</tr>
<tr>
<td>XML文本</td>
<td>XML</td>
</tr>
</tbody>
</table>
<h2 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a>聚集函数</h2>
<p>聚集函数可以直接对查询结果进行统计
但是只能出现在<code>SELECT</code>的后面，而且只会返回一个元组</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>返回值</th>
</tr>
</thead>
<tbody>
<tr>
<td>CHAR_LENGTH(string)</td>
<td>字符串长度</td>
</tr>
<tr>
<td>LOWER(string)</td>
<td>字符串全部转换为小写</td>
</tr>
<tr>
<td>UPPER(string)</td>
<td>字符串全部转换为大写</td>
</tr>
<tr>
<td>SUBSTRING(source, n, len)</td>
<td>取长度为len的子串</td>
</tr>
<tr>
<td>MAX(column)</td>
<td>制定列的最大值</td>
</tr>
<tr>
<td>MIN(column)</td>
<td>制定列的最小值</td>
</tr>
<tr>
<td>AVG(column)</td>
<td>制定列的平均值</td>
</tr>
<tr>
<td>SUM(column)</td>
<td>制定列的总和</td>
</tr>
<tr>
<td>CURRENT_DATE()</td>
<td>当前日期</td>
</tr>
<tr>
<td>COUNT(*)</td>
<td>计算总行数</td>
</tr>
<tr>
<td>COUNT(EXP)</td>
<td>计算非空行数</td>
</tr>
</tbody>
</table>
<h2 id="与关系代数的联系"><a href="#与关系代数的联系" class="headerlink" title="与关系代数的联系"></a>与关系代数的联系</h2>
<table>
<thead>
<tr>
<th>关系运算符</th>
<th>SQL关键字</th>
</tr>
</thead>
<tbody>
<tr>
<td>选择</td>
<td>WHERE</td>
</tr>
<tr>
<td>投影</td>
<td>SELECT</td>
</tr>
<tr>
<td>笛卡尔积</td>
<td>FROM</td>
</tr>
</tbody>
</table>
<h2 id="数据查询"><a href="#数据查询" class="headerlink" title="数据查询"></a>数据查询</h2>
<h3 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h3>
<table>
<thead>
<tr>
<th>类型</th>
<th>命令</th>
</tr>
</thead>
<tbody>
<tr>
<td>无条件查询</td>
<td>SELECT... FROM</td>
</tr>
<tr>
<td>条件查询</td>
<td>SELECT...FROM...WHERE</td>
</tr>
<tr>
<td>列的别名</td>
<td>... AS ...</td>
</tr>
<tr>
<td>带表达式的查询</td>
<td>SELECT <expression></expression></td>
</tr>
<tr>
<td>字符串匹配</td>
<td>LIKE</td>
</tr>
<tr>
<td>结果去重</td>
<td>DISTINCT</td>
</tr>
<tr>
<td>结果排序</td>
<td>ORDER BY</td>
</tr>
</tbody>
</table>
<h3 id="无条件查询"><a href="#无条件查询" class="headerlink" title="无条件查询"></a>无条件查询</h3>
<p>SQL语句：<code>SELECT &lt;字段列表&gt; FROM &lt;表名&gt;</code></p>
<p>可以用<code>*</code>表示所有列名；</p>
<p>例如查询所有医生的信息：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Doctor;</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="/assets/Database/image-20241027123444923.png" alt="image-20241027123444923"></p>
<h3 id="条件查询"><a href="#条件查询" class="headerlink" title="条件查询"></a>条件查询</h3>
<p>SQL语句：<code>SELECT &lt;字段列表&gt; FROM &lt;表名&gt; WHERE &lt;查询条件&gt;</code></p>
<p>条件之间的连接可以使用以下的连接运算符：</p>
<p><img src="/assets/Database/image-20241027123645997.png" alt="image-20241027123645997"></p>
<p>例如：查询年龄小于或等于40岁的男医生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">FROM</span>  Doctor  <span class="keyword">WHERE</span> Dsex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span> <span class="keyword">AND</span> Dage<span class="operator">&lt;=</span><span class="number">40</span> ;</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="/assets/Database/image-20241027123844916.png" alt="image-20241027123844916"></p>
<h3 id="列的别名"><a href="#列的别名" class="headerlink" title="列的别名"></a>列的别名</h3>
<p>改变查询显示列的标题，用关键字<code>AS</code>,跟在<code>SELECT</code>的属性后面；</p>
<p>SQL语句：<code>SELECT &lt;字段1&gt; AS &lt;别名1&gt;,..., &lt;字段吗&gt; AS &lt;别名m&gt; FROM &lt;表名&gt;</code></p>
<p>例：查询医生姓名和职称并重命名</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Dname <span class="keyword">AS</span> 医生姓名, Dlevel 专业职称 <span class="keyword">FROM</span> Doctor;</span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<p><img src="/assets/Database/image-20241027124146262.png" alt="image-20241027124146262"></p>
<h3 id="查询表达式"><a href="#查询表达式" class="headerlink" title="查询表达式"></a>查询表达式</h3>
<p>查询条件可以用表达式表示</p>
<p>例：在药品信息表中，查询药品单价提高15%后超过30元的药品信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Mno 编号，Mname 药品名，Mprice 单价，Mprice<span class="operator">*</span><span class="number">1.15</span> 调整单价 <span class="keyword">FROM</span> medicine  <span class="keyword">WHERE</span> Mprice<span class="operator">*</span><span class="number">1.15</span><span class="operator">&gt;=</span><span class="number">30</span>;</span><br></pre></td></tr></table></figure>
<h3 id="字符串匹配"><a href="#字符串匹配" class="headerlink" title="字符串匹配"></a>字符串匹配</h3>
<p>字符串的模式匹配：正则表达式支持</p>
<ul>
<li><code>%</code>:表示任意长度（包括长度为0）的字符串</li>
<li><code>_</code>：表示任意单个字符</li>
</ul>
<p>例如：查询职称为副某的医生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>  <span class="keyword">From</span> Doctor  <span class="keyword">Where</span> Dlevel <span class="keyword">Like</span> <span class="string">&#x27;副%&#x27;</span>;</span><br></pre></td></tr></table></figure>
<h3 id="结果去重"><a href="#结果去重" class="headerlink" title="结果去重"></a>结果去重</h3>
<p>使用<code>DISTINCT</code>合并查询结果的重复记录</p>
<p>例如：查询部门编号</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> Ddeptno <span class="keyword">FROM</span> Doctor; </span><br></pre></td></tr></table></figure>
<h3 id="结果排序"><a href="#结果排序" class="headerlink" title="结果排序"></a>结果排序</h3>
<p>使用<code>ORDER BY</code></p>
<ul>
<li>系统缺省为升序排序<code>ASC</code></li>
<li>也可以设定为降序<code>DESC</code></li>
</ul>
<p>例如：按部门编号升序而按年龄降序查询医生信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">From</span> Doctor  <span class="keyword">ORDER</span> <span class="keyword">BY</span> Ddeptno <span class="keyword">ASC</span> ,Dage <span class="keyword">DESC</span> ;</span><br></pre></td></tr></table></figure>
<h3 id="统计查询"><a href="#统计查询" class="headerlink" title="统计查询"></a>统计查询</h3>
<p>统计查询是通过聚集函数实现的；它可以对查询结果直接进行统计；</p>
<ul>
<li>聚集函数一般忽略空值；</li>
<li>选项<code>DISTINCT</code>表示只计算不同的记录值，不计入重复值和空行；</li>
<li>一次聚集函数返回一条<strong>记录</strong></li>
</ul>
<p>分组查询：使用<code>GROUP BY</code>，对所查询的表按字段进行分组，值相同的在一组，和聚集函数一起使用，聚集函数对每一组产生一个统计结果</p>
<p>分组筛选:使用<code>HAVING</code>子句，选出复合条件的统计分组，放在<code>GROUPBY</code>子句后</p>
<p>例如：</p>
<p>查询申请了计算机专业总申请数量</p>
<p>查询各个专业总申请数量;</p>
<p>计算机专业申请者数量大于等于2的高校；</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> Apply <span class="keyword">WHERE</span> Major<span class="operator">=</span><span class="string">&#x27;计算机&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)  <span class="keyword">FROM</span> Apply  sID cID <span class="keyword">GROUP</span> <span class="keyword">BY</span> major;</span><br><span class="line"><span class="keyword">SELECT</span> cID, <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> sID) <span class="keyword">FROM</span> Apply <span class="keyword">WHERE</span> Major<span class="operator">=</span><span class="string">&#x27;计算机&#x27;</span> <span class="keyword">GROUP</span> <span class="keyword">BY</span> cID <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> sID) <span class="operator">&gt;=</span><span class="number">2</span>;</span><br></pre></td></tr></table></figure>
<h3 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h3>
<p>连接满足查询条件或结果来自多个表；
连接同名之短时需要消除歧义；
连接条件的不同特点：等值连接，非等值连接，自然连接，自连接</p>
<h4 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h4>
<p>找出符合条件的共有记录，</p>
<ul>
<li><code>FROM R1, R2 WHERE R1.A1 &lt;比较运算符&gt; R2.A2</code></li>
<li><code>FROM R1 INNER JOIN R2 ON + R1.A1 &lt;比较运算&gt; R2.A2</code></li>
<li><code>FROM R1 INNER JOIN R2 USING(A1)</code></li>
</ul>
<h4 id="等值连接"><a href="#等值连接" class="headerlink" title="等值连接"></a>等值连接</h4>
<p>例如：
在医生基本信息表中，需要查询患者的每个处方用药信息;</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> RecipeDetail.<span class="operator">*</span> Medicine.<span class="operator">*</span> <span class="keyword">FROM</span> RecipeDetail, Medicine <span class="keyword">WHERE</span> RecipeDetail.Mno<span class="operator">=</span>Medicine.Mno;</span><br></pre></td></tr></table></figure>
<h4 id="自然连接"><a href="#自然连接" class="headerlink" title="自然连接"></a>自然连接</h4>
<p>要求连接列的列名相同，并且查询结果列不重复 NATURE JOIN
例如：在医院信息数据库中，需要查询开出处方的医生信息。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> Rno,Pno,Dno,Dname,Dsex,Dage,Ddeptno,Dlevel</span><br><span class="line"><span class="keyword">FROM</span> RecipeMaster R NATUAL <span class="keyword">JOIN</span> Doctor D </span><br><span class="line"><span class="keyword">FROM</span> RecipeMaster R NATUAL <span class="keyword">JOIN</span> Doctor D</span><br><span class="line"><span class="keyword">SELECT</span> Rno,Pno,D.Dno,Dname,Dsex,Dage,Ddeptno,Dlevel </span><br></pre></td></tr></table></figure>
<h4 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h4>
<p>支持表自身的连接,即同一张表的两个副本之间的连接
例如：在医院部门表中，需要医院的各部门名称和上级部门名称</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> First.DeptName 部门名称,Second.DeptName 上级部门</span><br><span class="line"><span class="keyword">FROM</span> Dept <span class="keyword">First</span> ,Dept <span class="keyword">Second</span></span><br><span class="line"><span class="keyword">WHERE</span> First.ParentDeptNo<span class="operator">=</span>Second.DeptNo</span><br></pre></td></tr></table></figure>
<h4 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h4>
<p>左外连接：<code>LEFT OUTER JOIN</code>
右外连接：<code>RIGHT OUTER JOIN</code>
全外连接：<code>FULL OUTER JOIN</code>
不一定所有数据库支持外连接；</p>
<h3 id="嵌套查询"><a href="#嵌套查询" class="headerlink" title="嵌套查询"></a>嵌套查询</h3>
<p>在一个查询语句中包含另一个完整的查询语句；
外层的查询：父查询
内层的查询：子查询
子查询的结果作为主查询条件的一部分；</p>
<ul>
<li>不相关子查询：子查询条件不依赖于主查询，独立执行，顺序从内至外；</li>
<li>相关子查询：子查询依赖于主查询，子查询需要引用主查询的表
例如：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sID,sName，GPA</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> Apply</span><br><span class="line"><span class="keyword">WHERE</span> cID<span class="operator">=</span>‘<span class="number">10614</span>’<span class="keyword">AND</span> GPA<span class="operator">&gt;</span></span><br><span class="line">（<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(GPA)</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> Apply </span><br><span class="line"><span class="keyword">WHERE</span> cID<span class="operator">=</span>‘<span class="number">10614</span>’）;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> sID,sName，GPA</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> Apply A</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">AND</span> GPA<span class="operator">&gt;</span></span><br><span class="line">（<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(GPA)</span><br><span class="line"><span class="keyword">FROM</span> Student <span class="keyword">NATURAL</span> <span class="keyword">JOIN</span> Apply B </span><br><span class="line"><span class="keyword">WHERE</span> A.cID<span class="operator">=</span>B.cID）;</span><br></pre></td></tr></table></figure>
<p>子查询结果是一个关系，可以利用集合运算符</p>
<ul>
<li><code>IN/NOT IN</code>: 测试一个元素是否属于一个集合</li>
<li><code>EXISTS/NOT EXISTS</code>：测试一个集合是否为空</li>
<li>关键字在父查询的<code>FROM</code>子后</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sName <span class="keyword">FROM</span> Student </span><br><span class="line"><span class="keyword">WHERE</span> sID</span><br><span class="line"><span class="keyword">IN</span></span><br><span class="line">( <span class="keyword">SELECT</span> sID <span class="keyword">FROM</span> Apply</span><br><span class="line"><span class="keyword">WHERE</span> major<span class="operator">=</span>‘计算机’);</span><br><span class="line"><span class="keyword">SELECT</span> sName <span class="keyword">FROM</span> Student S1</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span></span><br><span class="line">( <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Student S2</span><br><span class="line"><span class="keyword">WHERE</span> S2.GPA<span class="operator">&gt;</span>S1.GPA);</span><br></pre></td></tr></table></figure>
<h3 id="谓词"><a href="#谓词" class="headerlink" title="谓词"></a>谓词</h3>
<ul>
<li>与集合所有元素比较<code>ALL</code>
例如GPA最高的学生姓名<code>SELECT sName FROM Student WHERE GPD &gt;= ALL (SELECT GPA FROM Student)</code></li>
<li>与集合中任意一个元素比较
例如GPA最高的学生姓名<code>SELECT sName FROM WHERE NOT GPA &lt; ANY (SELECT GPA FROM Student)</code></li>
</ul>
<p>应该优先选择子查询而不是连接查询</p>
<ul>
<li>查询多次带来的IO开销不可忽略</li>
<li>连接查询在内部有查找优化（索引+二分），性能并不是线性相乘</li>
</ul>
<h2 id="数据更新"><a href="#数据更新" class="headerlink" title="数据更新"></a>数据更新</h2>
<h3 id="插入操作"><a href="#插入操作" class="headerlink" title="插入操作"></a>插入操作</h3>
<p>引入关键字：<code>INSERT INTO … VALUES</code>
格式如下</p>
<ul>
<li>表名：指要插入数据的目标表</li>
<li>列名：指定表的目标列，参数省略时默认全部列</li>
<li>值表：具体要插入的值</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> [(<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>)] <span class="keyword">VALUES</span> (<span class="operator">&lt;</span>值表<span class="operator">&gt;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="增加操作"><a href="#增加操作" class="headerlink" title="增加操作"></a>增加操作</h3>
<p>格式为</p>
<ul>
<li><code>select</code>子句中选择的列应该和列名保持对应</li>
<li>类型和长度兼容，列名可以不同</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> [(<span class="operator">&lt;</span>列名<span class="operator">&gt;</span>)] <span class="operator">&lt;</span><span class="keyword">select</span>子句<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="修改操作"><a href="#修改操作" class="headerlink" title="修改操作"></a>修改操作</h3>
<p>引入关键字<code>UPDATE</code>
格式为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> </span><br><span class="line"><span class="keyword">SET</span> <span class="operator">&lt;</span>列<span class="number">1</span><span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="number">1</span><span class="operator">&gt;</span>, <span class="operator">&lt;</span>列<span class="number">2</span><span class="operator">&gt;=</span><span class="operator">&lt;</span>表达式<span class="number">2</span><span class="operator">&gt;</span>,…</span><br><span class="line">[<span class="keyword">WHERE</span>]</span><br></pre></td></tr></table></figure>
<h3 id="数据删除"><a href="#数据删除" class="headerlink" title="数据删除"></a>数据删除</h3>
<p>引入关键字<code>DELETE</code>
格式为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> <span class="operator">&lt;</span>表名<span class="operator">&gt;</span> <span class="keyword">WHERE</span> <span class="operator">&lt;</span>条件<span class="operator">&gt;</span></span><br></pre></td></tr></table></figure></main>


<script src="/js/theme.js"></script>


<script src="/js/code-block-header.js"></script>


<script src="/js/code-block-copy.js"></script>


<script src="/js/code-block-theme-toggle.js"></script>


<script src="/js/code-block.js"></script>



<link rel="stylesheet" href="/css/article.css">

    
    <!-- giscus评论区 -->
    
  <div id="giscus_thread"></div>

  </div>
</article>
  
</main>

      <!-- 页脚 -->
      <footer class="footer">
  
  <span>Copyright © Kytolly(shiroi)</span>
  
  <div class="theme-switch-wrapper">
    <div class="theme-switch">
      <div class="theme-switch-item light-mode active">
        <img src="/icon/light.svg" class="icon">
      </div>
      <div class="theme-switch-item dark-mode">
        <img src="/icon/dark.svg" class="icon">
      </div>
    </div>
  </div>
</footer>


<link rel="stylesheet" href="/css/footer.css">


<script src="/js/theme-switcher.js"></script>


<script src="/js/giscus.js"></script>


      
  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <img src="/icon/search.svg" alt="Search Icon" class="search-icon" style="width:1.2em;height:1.2em;vertical-align:middle;">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="searching..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <img src="/icon/search.svg" alt="Search Icon" style="width:5em;height:5em;">
        </div>
        <ul id="search-results"></ul>
      </div>
    </div>
  </div>

<link rel="stylesheet" href="/css/search.css">



    </div>
    
<script src="/js/background.js"></script>

  </body>

</html>